const N={};import F from"../../../__snowpack__/env.js";N.env=F;import i,{useCallback as I,useEffect as s,useImperativeHandle as M,useMemo as V,useRef as q,useState as x}from"../../../web_modules/react.js";import{contentHeight as J,position as O,primaryColor as Q,rem as a,size as j,transitionProps as $}from"../../utils/style.js";import X from"../ChartToolbox.js";import Y from"../../../web_modules/react-spinners/HashLoader.js";import Z from"../../assets/images/netron.png.proxy.js";import l from"../../../web_modules/styled-components.js";import{toast as D}from"../../../web_modules/react-toastify.js";import S from"../../hooks/useTheme.js";import{useTranslation as ee}from"../../../web_modules/react-i18next.js";const f=N.env.SNOWPACK_PUBLIC_PATH;let W=`${window.location.protocol}//${window.location.host}`;if(f.startsWith("http")){const r=new URL(f);W=`${r.protocol}//${r.host}`}const R=a(40),oe=l.div.withConfig({displayName:"Graph__Wrapper",componentId:"ojmbku-0"})(["position:relative;height:",";background-color:var(--background-color);display:flex;flex-direction:column;justify-content:center;align-items:center;",""],J,$("background-color")),te=l.div.withConfig({displayName:"Graph__RenderContent",componentId:"ojmbku-1"})(["position:absolute;top:0;left:0;"," opacity:",";z-index:",";pointer-events:",";"],j("100%","100%"),r=>r.show?1:0,r=>r.show?0:-1,r=>r.show?"auto":"none"),re=l(X).withConfig({displayName:"Graph__Toolbox",componentId:"ojmbku-2"})(["height:",";border-bottom:1px solid var(--border-color);padding:0 ",";",""],R,a(20),$("border-color")),ne=l.div.withConfig({displayName:"Graph__Content",componentId:"ojmbku-3"})(["position:relative;height:calc(100% - ",");> iframe{"," border:none;}> .powered-by{display:block;"," color:var(--graph-copyright-color);font-size:",";user-select:none;img{height:1em;filter:var(--graph-copyright-logo-filter);vertical-align:middle;}}"],R,j("100%","100%"),O("absolute",null,null,a(20),a(30)),a(14)),ie=l.div.withConfig({displayName:"Graph__Loading",componentId:"ojmbku-4"})([""," display:flex;flex-direction:column;justify-content:center;align-items:center;overscroll-behavior:none;cursor:progress;font-size:",";line-height:",";"],j("100%","100%"),a(16),a(60)),A=i.forwardRef(({files:r,uploader:k,showAttributes:z,showInitializers:E,showNames:L,horizontal:T,onRendered:c,onOpened:d,onSearch:m,onShowModelProperties:u,onShowNodeProperties:p,onShowNodeDocumentation:g},P)=>{const{t:v}=ee("graph"),H=S(),[o,B]=x(!1),[b,h]=x(!1),[_,U]=x(!1),G=q(null),y=I(t=>{if(t.data){const{type:w,data:n}=t.data;switch(w){case"status":switch(n){case"ready":return B(!0);case"loading":return h(!0);case"rendered":h(!1),U(!0),c==null||c();return}return;case"opened":return d==null?void 0:d(n);case"search":return m==null?void 0:m(n);case"cancel":return h(!1);case"error":D(n),h(!1);return;case"show-model-properties":return u==null?void 0:u(n);case"show-node-properties":return p==null?void 0:p(n);case"show-node-documentation":return g==null?void 0:g(n)}}},[c,d,m,u,p,g]),e=I((t,w)=>{var n,C;(n=G.current)===null||n===void 0||((C=n.contentWindow)===null||C===void 0)||C.postMessage({type:t,data:w},W)},[]);s(()=>(window.addEventListener("message",y),e("ready"),()=>{window.removeEventListener("message",y)}),[y,e]),s(()=>o&&e("change-files",r)||void 0,[e,r,o]),s(()=>o&&e("toggle-attributes",z)||void 0,[e,z,o]),s(()=>o&&e("toggle-initializers",E)||void 0,[e,E,o]),s(()=>o&&e("toggle-names",L)||void 0,[e,L,o]),s(()=>o&&e("toggle-direction",T)||void 0,[e,T,o]),s(()=>o&&e("toggle-theme",H)||void 0,[e,H,o]),M(P,()=>({export(t){e("export",t)},changeGraph(t){e("change-graph",t)},search(t){e("search",t)},select(t){e("select",t)},showModelProperties(){e("show-model-properties")},showNodeDocumentation(t){e("show-node-documentation",t)}}));const K=V(()=>!o||b?i.createElement(ie,null,i.createElement(Y,{size:"60px",color:Q})):o&&!_?k:null,[o,b,_,k]);return i.createElement(oe,null,K,i.createElement(te,{show:!b&&_},i.createElement(re,{items:[{icon:"zoom-in",tooltip:v("graph:zoom-in"),onClick:()=>e("zoom-in")},{icon:"zoom-out",tooltip:v("graph:zoom-out"),onClick:()=>e("zoom-out")},{icon:"restore-size",tooltip:v("graph:restore-size"),onClick:()=>e("zoom-reset")}],reversed:!0,tooltipPlacement:"bottom"}),i.createElement(ne,null,i.createElement("iframe",{ref:G,src:`${f}/netron/index.html`,frameBorder:0,scrolling:"no",marginWidth:0,marginHeight:0}),i.createElement("a",{className:"powered-by",href:"https://github.com/lutzroeder/netron",target:"_blank",rel:"noreferrer"},"Powered by ",i.createElement("img",{src:f+Z,alt:"netron"})))))});A.displayName="Graph";export default A;

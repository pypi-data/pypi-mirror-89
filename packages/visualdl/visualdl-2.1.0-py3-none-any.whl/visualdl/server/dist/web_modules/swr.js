import"./common/_commonjsHelpers-4f955397.js";import{r as m}from"./common/index-378ae6ec.js";var se=Object.prototype.hasOwnProperty;function Q(i,n){var e,f;if(i===n)return!0;if(i&&n&&(e=i.constructor)===n.constructor){if(e===Date)return i.getTime()===n.getTime();if(e===RegExp)return i.toString()===n.toString();if(e===Array){if((f=i.length)===n.length)for(;f--&&Q(i[f],n[f]););return f===-1}if(!e||typeof i=="object"){f=0;for(e in i){if(se.call(i,e)&&++f&&!se.call(n,e))return!1;if(!(e in n)||!Q(i[e],n[e]))return!1}return Object.keys(n).length===f}}return i!==i&&n!==n}var X=new WeakMap,le=0;function ge(i){if(!i.length)return"";for(var n="arg",e=0;e<i.length;++e){if(i[e]===null){n+="@null";continue}var f=void 0;typeof i[e]!="object"&&typeof i[e]!="function"?typeof i[e]=="string"?f='"'+i[e]+'"':f=String(i[e]):X.has(i[e])?f=X.get(i[e]):(f=le,X.set(i[e],le++)),n+="@"+f}return n}var pe=function(){function i(n){n===void 0&&(n={}),this.__cache=new Map(Object.entries(n)),this.__listeners=[]}return i.prototype.get=function(n){var e=this.serializeKey(n)[0];return this.__cache.get(e)},i.prototype.set=function(n,e){var f=this.serializeKey(n)[0];this.__cache.set(f,e),this.notify()},i.prototype.keys=function(){return Array.from(this.__cache.keys())},i.prototype.has=function(n){var e=this.serializeKey(n)[0];return this.__cache.has(e)},i.prototype.clear=function(){this.__cache.clear(),this.notify()},i.prototype.delete=function(n){var e=this.serializeKey(n)[0];this.__cache.delete(e),this.notify()},i.prototype.serializeKey=function(n){var e=null;if(typeof n=="function")try{n=n()}catch(r){n=""}Array.isArray(n)?(e=n,n=ge(n)):n=String(n||"");var f=n?"err@"+n:"",u=n?"validating@"+n:"";return[n,e,f,u]},i.prototype.subscribe=function(n){var e=this;if(typeof n!="function")throw new Error("Expected the listener to be a function.");var f=!0;return this.__listeners.push(n),function(){if(!f)return;f=!1;var u=e.__listeners.indexOf(n);u>-1&&(e.__listeners[u]=e.__listeners[e.__listeners.length-1],e.__listeners.length--)}},i.prototype.notify=function(){for(var n=0,e=this.__listeners;n<e.length;n++){var f=e[n];f()}},i}();function me(){return typeof navigator.onLine!="undefined"?navigator.onLine:!0}function we(){return typeof document!="undefined"&&typeof document.visibilityState!="undefined"?document.visibilityState!=="hidden":!0}var be=function(i){return fetch(i).then(function(n){return n.json()})},Y={isOnline:me,isDocumentVisible:we,fetcher:be},h=new pe;function Oe(i,n,e,f,u){if(!e.isDocumentVisible())return;if(typeof e.errorRetryCount=="number"&&u.retryCount>e.errorRetryCount)return;var r=Math.min(u.retryCount||0,8),s=~~((Math.random()+.5)*(1<<r))*e.errorRetryInterval;setTimeout(f,s,u)}var de=typeof window!="undefined"&&navigator.connection&&["slow-2g","2g"].indexOf(navigator.connection.effectiveType)!==-1,Z={onLoadingSlow:function(){},onSuccess:function(){},onError:function(){},onErrorRetry:Oe,errorRetryInterval:(de?10:5)*1e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:(de?5:3)*1e3,refreshInterval:0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshWhenHidden:!1,refreshWhenOffline:!1,shouldRetryOnError:!0,suspense:!1,compare:Q,fetcher:Y.fetcher,isOnline:Y.isOnline,isDocumentVisible:Y.isDocumentVisible},ee=m.createContext({});ee.displayName="SWRConfigContext";var re=function(i,n,e,f){function u(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function a(c){try{t(f.next(c))}catch(d){s(d)}}function y(c){try{t(f.throw(c))}catch(d){s(d)}}function t(c){c.done?r(c.value):u(c.value).then(a,y)}t((f=f.apply(i,n||[])).next())})},ne=function(i,n){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},f,u,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(c){return y([t,c])}}function y(t){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,u&&(r=t[0]&2?u.return:t[0]?u.throw||((r=u.return)&&r.call(u),0):u.next)&&!(r=r.call(u,t[1])).done)return r;(u=0,r)&&(t=[t[0]&2,r.value]);switch(t[0]){case 0:case 1:r=t;break;case 4:return e.label++,{value:t[1],done:!1};case 5:e.label++,u=t[1],t=[0];continue;case 7:t=e.ops.pop(),e.trys.pop();continue;default:if(!(r=e.trys,r=r.length>0&&r[r.length-1])&&(t[0]===6||t[0]===2)){e=0;continue}if(t[0]===3&&(!r||t[1]>r[0]&&t[1]<r[3])){e.label=t[1];break}if(t[0]===6&&e.label<r[1]){e.label=r[1],r=t;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(t);break}r[2]&&e.ops.pop(),e.trys.pop();continue}t=n.call(i,e)}catch(c){t=[6,c],u=0}finally{f=r=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}},te=typeof window=="undefined"||!!(typeof Deno!="undefined"&&Deno&&Deno.version&&Deno.version.deno),_e=te?null:window.requestAnimationFrame||function(i){return setTimeout(i,1)},ie=te?m.useEffect:m.useLayoutEffect,b={},I={},F={},ue={},W={},N={},H={},fe=function(){var i=0;return function(){return++i}}();if(!te&&window.addEventListener){var ae=function(i){if(!Z.isDocumentVisible()||!Z.isOnline())return;for(var n in i)i[n][0]&&i[n][0]()};window.addEventListener("visibilitychange",function(){return ae(F)},!1),window.addEventListener("focus",function(){return ae(F)},!1),window.addEventListener("online",function(){return ae(ue)},!1)}var Re=function(i,n){n===void 0&&(n=!0);var e=h.serializeKey(i),f=e[0],u=e[2],r=e[3];if(!f)return Promise.resolve();var s=W[f];if(f&&s){for(var a=h.get(f),y=h.get(u),t=h.get(r),c=[],d=0;d<s.length;++d)c.push(s[d](n,a,y,t,d>0));return Promise.all(c).then(function(){return h.get(f)})}return Promise.resolve(h.get(f))},oe=function(i,n,e,f){var u=W[i];if(i&&u)for(var r=0;r<u.length;++r)u[r](!1,n,e,f)},Se=function(i,n,e){return e===void 0&&(e=!0),re(void 0,void 0,void 0,function(){var f,u,r,s,a,y,t,c,d,j,T,E,V;return ne(this,function(w){switch(w.label){case 0:if(f=h.serializeKey(i),u=f[0],r=f[2],!u)return[2];if(typeof n=="undefined")return[2,Re(i,e)];if(N[u]=fe()-1,H[u]=0,s=N[u],a=I[u],c=!1,n&&typeof n=="function")try{n=n(h.get(u))}catch(p){t=p}if(!(n&&typeof n.then=="function"))return[3,5];c=!0,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,n];case 2:return y=w.sent(),[3,4];case 3:return d=w.sent(),t=d,[3,4];case 4:return[3,6];case 5:y=n,w.label=6;case 6:return j=function(){if(s!==N[u]||a!==I[u]){if(t)throw t;return!0}},j()?[2,y]:(typeof y!="undefined"&&h.set(u,y),h.set(r,t),H[u]=fe()-1,c?[3,8]:[4,0]);case 7:if(w.sent(),j())return[2,y];w.label=8;case 8:if(T=W[u],T){for(E=[],V=0;V<T.length;++V)E.push(T[V](!!e,y,t,void 0,V>0));return[2,Promise.all(E).then(function(){if(t)throw t;return h.get(u)})]}if(t)throw t;return[2,y]}})})};function Te(){for(var i=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var f,u,r={};n.length>=1&&(f=n[0]),n.length>2?(u=n[1],r=n[2]):typeof n[1]=="function"?u=n[1]:typeof n[1]=="object"&&(r=n[1]);var s=h.serializeKey(f),a=s[0],y=s[1],t=s[2],c=s[3];r=Object.assign({},Z,m.useContext(ee),r);var d=m.useRef(r);ie(function(){d.current=r}),typeof u=="undefined"&&(u=r.fetcher);var j=function(){var o=h.get(a);return typeof o=="undefined"?r.initialData:o},T=j(),E=h.get(t),V=!!h.get(c),w=m.useRef({data:!1,error:!1,isValidating:!1}),p=m.useRef({data:T,error:E,isValidating:V});m.useDebugValue(p.current.data);var he=m.useState(null)[1],x=m.useCallback(function(o){var v=!1;for(var l in o){if(p.current[l]===o[l])continue;p.current[l]=o[l],w.current[l]&&(v=!0)}if(v||r.suspense){if(L.current||!q.current)return;he({})}},[]),L=m.useRef(!1),K=m.useRef(a),q=m.useRef(!1),k=m.useRef({emit:function(o){for(var v,l=[],g=1;g<arguments.length;g++)l[g-1]=arguments[g];if(L.current)return;if(!q.current)return;(v=d.current)[o].apply(v,l)}}),ce=m.useCallback(function(o,v){return Se(K.current,o,v)},[]),G=function(o,v){if(!v)return;o[a]?o[a].push(v):o[a]=[v]},$=function(o,v){if(o[a]){var l=o[a],g=l.indexOf(v);g>=0&&(l[g]=l[l.length-1],l.pop())}},_=m.useCallback(function(o){return o===void 0&&(o={}),re(i,void 0,void 0,function(){var v,l,g,S,P,C,O,M;return ne(this,function(R){switch(R.label){case 0:if(!a||!u)return[2,!1];if(L.current)return[2,!1];o=Object.assign({dedupe:!1},o),v=!0,l=typeof b[a]!="undefined"&&o.dedupe,R.label=1;case 1:return R.trys.push([1,6,,7]),x({isValidating:!0}),h.set(c,!0),l||oe(a,p.current.data,p.current.error,!0),g=void 0,S=void 0,l?(S=I[a],[4,b[a]]):[3,3];case 2:return g=R.sent(),[3,5];case 3:return r.loadingTimeout&&!h.get(a)&&setTimeout(function(){v&&k.current.emit("onLoadingSlow",a,r)},r.loadingTimeout),y!==null?b[a]=u.apply(void 0,y):b[a]=u(a),I[a]=S=fe(),[4,b[a]];case 4:g=R.sent(),setTimeout(function(){delete b[a],delete I[a]},r.dedupingInterval),k.current.emit("onSuccess",g,a,r),R.label=5;case 5:return P=I[a]>S||N[a]&&(S<=N[a]||S<=H[a]||H[a]===0),P?(x({isValidating:!1}),[2,!1]):(h.set(a,g),h.set(t,void 0),h.set(c,!1),C={isValidating:!1},typeof p.current.error!="undefined"&&(C.error=void 0),r.compare(p.current.data,g)||(C.data=g),x(C),l||oe(a,g,C.error,!1),[3,7]);case 6:return O=R.sent(),delete b[a],delete I[a],h.set(t,O),p.current.error!==O&&(x({isValidating:!1,error:O}),l||oe(a,void 0,O,!1)),k.current.emit("onError",O,a,r),r.shouldRetryOnError&&(M=(o.retryCount||0)+1,k.current.emit("onErrorRetry",O,a,r,_,Object.assign({dedupe:!0},o,{retryCount:M}))),[3,7];case 7:return v=!1,[2,!0]}})})},[a]);ie(function(){if(!a)return;L.current=!1,q.current=!0;var o=p.current.data,v=j();K.current!==a&&(K.current=a),r.compare(o,v)||x({data:v});var l=function(){return _({dedupe:!0})};(r.revalidateOnMount||!r.initialData&&r.revalidateOnMount===void 0)&&(typeof v!="undefined"?_e(l):l());var g=!1,S=function(){if(g||!d.current.revalidateOnFocus)return;g=!0,l(),setTimeout(function(){return g=!1},d.current.focusThrottleInterval)},P=function(){d.current.revalidateOnReconnect&&l()},C=function(O,M,R,B,J){O===void 0&&(O=!0),J===void 0&&(J=!0);var z={},U=!1;return typeof M!="undefined"&&!r.compare(p.current.data,M)&&(z.data=M,U=!0),p.current.error!==R&&(z.error=R,U=!0),typeof B!="undefined"&&p.current.isValidating!==B&&(z.isValidating=B,U=!0),U&&x(z),O?J?l():_():!1};return G(F,S),G(ue,P),G(W,C),function(){x=function(){return null},L.current=!0,$(F,S),$(ue,P),$(W,C)}},[a,_]),ie(function(){var o=null,v=function(){return re(i,void 0,void 0,function(){return ne(this,function(l){switch(l.label){case 0:return!p.current.error&&(d.current.refreshWhenHidden||d.current.isDocumentVisible())&&(d.current.refreshWhenOffline||d.current.isOnline())?[4,_({dedupe:!0})]:[3,2];case 1:l.sent(),l.label=2;case 2:return d.current.refreshInterval&&(o=setTimeout(v,d.current.refreshInterval)),[2]}})})};return d.current.refreshInterval&&(o=setTimeout(v,d.current.refreshInterval)),function(){o&&clearTimeout(o)}},[r.refreshInterval,r.refreshWhenHidden,r.refreshWhenOffline,_]);var ye=m.useMemo(function(){var o={revalidate:_,mutate:ce};return Object.defineProperties(o,{error:{get:function(){return w.current.error=!0,K.current===a?p.current.error:E},enumerable:!0},data:{get:function(){return w.current.data=!0,K.current===a?p.current.data:T},enumerable:!0},isValidating:{get:function(){return w.current.isValidating=!0,a?p.current.isValidating:!1},enumerable:!0}}),o},[_]);if(r.suspense){var A=h.get(a),D=h.get(t);if(typeof A=="undefined"&&(A=T),typeof D=="undefined"&&(D=E),typeof A=="undefined"&&typeof D=="undefined"){if(b[a]||_(),b[a]&&typeof b[a].then=="function")throw b[a];A=b[a]}if(typeof A=="undefined"&&D)throw D;return{error:D,data:A,revalidate:_,mutate:ce,isValidating:p.current.isValidating}}return ye}var Ce=ee.Provider,ve=function(){return ve=Object.assign||function(i){for(var n,e=1,f=arguments.length;e<f;e++){n=arguments[e];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(i[u]=n[u])}return i},ve.apply(this,arguments)},xe=function(i,n,e,f){function u(r){return r instanceof e?r:new e(function(s){s(r)})}return new(e||(e=Promise))(function(r,s){function a(c){try{t(f.next(c))}catch(d){s(d)}}function y(c){try{t(f.throw(c))}catch(d){s(d)}}function t(c){c.done?r(c.value):u(c.value).then(a,y)}t((f=f.apply(i,n||[])).next())})},Ie=function(i,n){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},f,u,r,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(c){return y([t,c])}}function y(t){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,u&&(r=t[0]&2?u.return:t[0]?u.throw||((r=u.return)&&r.call(u),0):u.next)&&!(r=r.call(u,t[1])).done)return r;(u=0,r)&&(t=[t[0]&2,r.value]);switch(t[0]){case 0:case 1:r=t;break;case 4:return e.label++,{value:t[1],done:!1};case 5:e.label++,u=t[1],t=[0];continue;case 7:t=e.ops.pop(),e.trys.pop();continue;default:if(!(r=e.trys,r=r.length>0&&r[r.length-1])&&(t[0]===6||t[0]===2)){e=0;continue}if(t[0]===3&&(!r||t[1]>r[0]&&t[1]<r[3])){e.label=t[1];break}if(t[0]===6&&e.label<r[1]){e.label=r[1],r=t;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(t);break}r[2]&&e.ops.pop(),e.trys.pop();continue}t=n.call(i,e)}catch(c){t=[6,c],u=0}finally{f=r=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}},je=function(i,n){var e={};for(var f in i)Object.prototype.hasOwnProperty.call(i,f)&&n.indexOf(f)<0&&(e[f]=i[f]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,f=Object.getOwnPropertySymbols(i);u<f.length;u++)n.indexOf(f[u])<0&&Object.prototype.propertyIsEnumerable.call(i,f[u])&&(e[f[u]]=i[f[u]]);return e};export default Te;export{Ce as SWRConfig,h as cache};

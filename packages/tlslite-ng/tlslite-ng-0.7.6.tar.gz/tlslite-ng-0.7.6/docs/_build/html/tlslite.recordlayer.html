
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tlslite.recordlayer module &#8212; tlslite-ng 0.7.6 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-tlslite.recordlayer">
<span id="tlslite-recordlayer-module"></span><h1>tlslite.recordlayer module<a class="headerlink" href="#module-tlslite.recordlayer" title="Permalink to this headline">¶</a></h1>
<p>Implementation of the TLS Record Layer protocol</p>
<dl class="class">
<dt id="tlslite.recordlayer.ConnectionState">
<em class="property">class </em><code class="sig-prename descclassname">tlslite.recordlayer.</code><code class="sig-name descname">ConnectionState</code><a class="headerlink" href="#tlslite.recordlayer.ConnectionState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Preserve the connection state for reading and writing data to records</p>
<dl class="method">
<dt id="tlslite.recordlayer.ConnectionState.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.ConnectionState.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance with empty encryption and MACing contexts</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.ConnectionState.getSeqNumBytes">
<code class="sig-name descname">getSeqNumBytes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.ConnectionState.getSeqNumBytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return encoded sequence number and increment it.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tlslite.recordlayer.RecordLayer">
<em class="property">class </em><code class="sig-prename descclassname">tlslite.recordlayer.</code><code class="sig-name descname">RecordLayer</code><span class="sig-paren">(</span><em class="sig-param">sock</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of TLS record layer protocol</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#tlslite.recordlayer.RecordLayer.version" title="tlslite.recordlayer.RecordLayer.version"><strong>version</strong></a> – the TLS version to use (tuple encoded as on the wire)</p></li>
<li><p><strong>sock</strong> – underlying socket</p></li>
<li><p><strong>client</strong> – whether the connection should use encryption</p></li>
<li><p><a class="reference internal" href="tlslite.tlsrecordlayer.html#tlslite.tlsrecordlayer.TLSRecordLayer.encryptThenMAC" title="tlslite.tlsrecordlayer.TLSRecordLayer.encryptThenMAC"><strong>encryptThenMAC</strong></a> – use the encrypt-then-MAC mechanism for record
integrity</p></li>
<li><p><strong>handshake_finished</strong> – used in SSL2, True if handshake protocol is over</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">sock</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.addPadding">
<code class="sig-name descname">addPadding</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.addPadding" title="Permalink to this definition">¶</a></dt>
<dd><p>Add padding to data so that it is multiple of block size</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.blockSize">
<em class="property">property </em><code class="sig-name descname">blockSize</code><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.blockSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of block used by current symmetric cipher (R/O)</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.calcPendingStates">
<code class="sig-name descname">calcPendingStates</code><span class="sig-paren">(</span><em class="sig-param">cipherSuite</em>, <em class="sig-param">masterSecret</em>, <em class="sig-param">clientRandom</em>, <em class="sig-param">serverRandom</em>, <em class="sig-param">implementations</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.calcPendingStates" title="Permalink to this definition">¶</a></dt>
<dd><p>Create pending states for encryption and decryption.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.calcSSL2PendingStates">
<code class="sig-name descname">calcSSL2PendingStates</code><span class="sig-paren">(</span><em class="sig-param">cipherSuite</em>, <em class="sig-param">masterSecret</em>, <em class="sig-param">clientRandom</em>, <em class="sig-param">serverRandom</em>, <em class="sig-param">implementations</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.calcSSL2PendingStates" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the keys for encryption and decryption in SSLv2</p>
<p>While we could reuse calcPendingStates(), we need to provide the
key-arg data for the server that needs to be passed up to handshake
protocol.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.calculateMAC">
<code class="sig-name descname">calculateMAC</code><span class="sig-paren">(</span><em class="sig-param">mac</em>, <em class="sig-param">seqnumBytes</em>, <em class="sig-param">contentType</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.calculateMAC" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the SSL/TLS version of a MAC</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.changeReadState">
<code class="sig-name descname">changeReadState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.changeReadState" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the cipher state to the pending one for read operations.</p>
<p>This should be done only once after a call to
<a class="reference internal" href="#tlslite.recordlayer.RecordLayer.calcPendingStates" title="tlslite.recordlayer.RecordLayer.calcPendingStates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calcPendingStates()</span></code></a> was
performed and directly after receiving a <code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeCipherSpec</span></code>
message.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.changeWriteState">
<code class="sig-name descname">changeWriteState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.changeWriteState" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the cipher state to the pending one for write operations.</p>
<p>This should be done only once after a call to
<a class="reference internal" href="#tlslite.recordlayer.RecordLayer.calcPendingStates" title="tlslite.recordlayer.RecordLayer.calcPendingStates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calcPendingStates()</span></code></a> was
performed and directly after sending a <code class="xref py py-class docutils literal notranslate"><span class="pre">ChangeCipherSpec</span></code>
message.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.getCipherImplementation">
<code class="sig-name descname">getCipherImplementation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.getCipherImplementation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the implementation used for the connection</p>
<p>‘python’ for tlslite internal implementation, ‘openssl’ for M2crypto
and ‘pycrypto’ for pycrypto
:rtype: str
:returns: Name of cipher implementation used, None if not initialised</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.getCipherName">
<code class="sig-name descname">getCipherName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.getCipherName" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the bulk cipher used by this connection</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of the cipher, like ‘aes128’, ‘rc4’, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.isCBCMode">
<code class="sig-name descname">isCBCMode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.isCBCMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if cipher uses CBC mode</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.recvRecord">
<code class="sig-name descname">recvRecord</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.recvRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Read, decrypt and check integrity of a single record</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>message header and decrypted message payload</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="tlslite.errors.html#tlslite.errors.TLSDecryptionFailed" title="tlslite.errors.TLSDecryptionFailed"><strong>TLSDecryptionFailed</strong></a> – when decryption of data failed</p></li>
<li><p><a class="reference internal" href="tlslite.errors.html#tlslite.errors.TLSBadRecordMAC" title="tlslite.errors.TLSBadRecordMAC"><strong>TLSBadRecordMAC</strong></a> – when record has bad MAC or padding</p></li>
<li><p><strong>socket.error</strong> – when reading from socket was unsuccessful</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.sendRecord">
<code class="sig-name descname">sendRecord</code><span class="sig-paren">(</span><em class="sig-param">msg</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.sendRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt, MAC and send arbitrary message as-is through socket.</p>
<p>Note that if the message was not fragmented to below 2**14 bytes
it will be rejected by the other connection side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msg</strong> (<a class="reference internal" href="tlslite.messages.html#tlslite.messages.ApplicationData" title="tlslite.messages.ApplicationData"><em>ApplicationData</em></a><em>, </em><em>HandshakeMessage</em><em>, </em><em>etc.</em>) – TLS message to send</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.shutdown">
<code class="sig-name descname">shutdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear read and write states</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordLayer.version">
<em class="property">property </em><code class="sig-name descname">version</code><a class="headerlink" href="#tlslite.recordlayer.RecordLayer.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the TLS version used by record layer</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tlslite.recordlayer.RecordSocket">
<em class="property">class </em><code class="sig-prename descclassname">tlslite.recordlayer.</code><code class="sig-name descname">RecordSocket</code><span class="sig-paren">(</span><em class="sig-param">sock</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordSocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Socket wrapper for reading and writing TLS Records</p>
<dl class="method">
<dt id="tlslite.recordlayer.RecordSocket.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">sock</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordSocket.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign socket to wrapper</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordSocket.recv">
<code class="sig-name descname">recv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordSocket.recv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single record from socket, handle SSLv2 and SSLv3 record layer</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>generator</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generator that returns 0 or 1 in case the read would be
blocking or a tuple containing record header (object) and record
data (bytearray) read from socket</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>socket.error</strong> – In case of network error</p></li>
<li><p><a class="reference internal" href="tlslite.errors.html#tlslite.errors.TLSAbruptCloseError" title="tlslite.errors.TLSAbruptCloseError"><strong>TLSAbruptCloseError</strong></a> – When the socket was closed on the other
side in middle of record receiving</p></li>
<li><p><a class="reference internal" href="tlslite.errors.html#tlslite.errors.TLSRecordOverflow" title="tlslite.errors.TLSRecordOverflow"><strong>TLSRecordOverflow</strong></a> – When the received record was longer than
allowed by TLS</p></li>
<li><p><a class="reference internal" href="tlslite.errors.html#tlslite.errors.TLSIllegalParameterException" title="tlslite.errors.TLSIllegalParameterException"><strong>TLSIllegalParameterException</strong></a> – When the record header was
malformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.recordlayer.RecordSocket.send">
<code class="sig-name descname">send</code><span class="sig-paren">(</span><em class="sig-param">msg</em>, <em class="sig-param">padding=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.recordlayer.RecordSocket.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send the message through socket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>bytearray</em>) – TLS message to send</p></li>
<li><p><strong>padding</strong> (<em>int</em>) – amount of padding to specify for SSLv2</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>socket.error</strong> – when write to socket failed</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">tlslite-ng</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Hubert Kario.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tlslite.recordlayer.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
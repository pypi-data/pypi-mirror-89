(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{225:function(e,t,n){},227:function(e,t,n){},269:function(e,t,n){},305:function(e,t,n){},411:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(3),s=n(35),i=n.n(s),o=(n(225),n(39)),j=n(15),d=n(433),l=n(434),u=n(417),b=n(424),h=n(435),O=(n(226),n(227),n(421)),p=new Set,f=new Set,x=function e(){f.forEach((function(e){return e("connecting")}));var t=window.location.protocol.replace("http","ws"),n=new WebSocket("".concat(t,"//").concat(window.location.host,"/ws"));return n.addEventListener("open",(function(){console.log("ws.open"),f.forEach((function(e){return e("connected")}))})),n.addEventListener("message",(function(e){console.log("ws.message",e.data);var t=JSON.parse(e.data);p.forEach((function(n){n(t,e)}))})),n.addEventListener("close",(function(){console.warn("ws.closed"),f.forEach((function(e){return e("closed")})),setTimeout((function(){x=e()}),3e3),n.close()})),n.addEventListener("error",(function(){console.error("ws.error")})),n}(),m=1;function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];return new Promise((function(t,c){var a=m++,r=y((function(e){"2.0"===e.jsonrpc&&e.id===a&&(r(),e.error?c(e.error):t(e.result))}));g({jsonrpc:"2.0",method:e,params:n,id:a}),setTimeout((function(){r(),c("JsonRpc timeout")}),1e4)}))}function g(e){if(x.readyState===WebSocket.OPEN){var t=JSON.stringify(e);console.log("ws.send",t),x.send(t)}else var n=S((function(t){"connected"===t&&(n(),g(e))}))}function w(e,t){function n(n,c){"method"in n&&n.method===e&&t(n.params,n,c)}p.add(n),v("subscribe",e);var c=S((function(t){"connected"===t&&v("subscribe",e)}));return function(){p.delete(n),v("unsubscribe",e),c()}}function y(e){return p.add(e),function(){p.delete(e)}}function S(e){return f.add(e),function(){f.delete(e)}}function E(){return Object(c.useEffect)((function(){return S((function(e){"connected"!==e?O.a.warning({title:"Not connected",key:"connection"}):O.a.close("connection")}))}),[]),null}var k=n(16),C=n(426);n(269);function T(e){return Object(r.jsx)("div",Object(k.a)({className:"grid-view"},e))}var N=n(24);function F(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(c.useReducer)(_,e)}function _(e){return!e}function A(e,t,n){var a=Object(c.useState)(),r=Object(N.a)(a,2),s=r[0],i=r[1],o=Object(c.useState)(!0),j=Object(N.a)(o,2),d=j[0],l=j[1],u=Object(c.useState)(e),b=Object(N.a)(u,2),h=b[0],O=b[1],p=F(!1),f=Object(N.a)(p,2),x=f[0],m=f[1],g=Object(c.useMemo)((function(){return n}),[JSON.stringify(n)]);return Object(c.useEffect)((function(){l(!0);var e=!0;return console.log("useRpc",t,g),v(t,g).then((function(t){e&&(O(t),i(void 0),l(!1))})).catch((function(t){e&&(console.error(t),i(t),l(!1))})),function(){e=!1}}),[t,g,x]),{error:s,pending:d,value:h,reload:m}}var I={train:[{name:"loading...",path:"",sessions:[]}],test:[{name:"loading...",path:"",sessions:[]}]};function M(){return A(I,"getDatasets")}function H(){var e=M();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Train datasets"}),Object(r.jsx)(T,{children:e.value.train.map((function(e){return Object(r.jsx)(D,Object(k.a)({},e),e.name)}))}),Object(r.jsx)("h3",{children:"Test datasets"}),Object(r.jsx)(T,{children:e.value.test.map((function(e){return Object(r.jsx)(D,Object(k.a)({},e),e.name)}))})]})}function D(e){return Object(r.jsxs)(C.a,{header:Object(r.jsx)(o.b,{to:e.path,children:e.name}),shaded:!0,children:[Object(r.jsxs)("div",{children:["Sessions: ",e.sessions.length]}),Object(r.jsxs)("div",{children:["Frames: ",e.sessions.reduce((function(e,t){return e+t.frames}),0)]})]})}var L=[];function R(){var e=A(L,"getModels");return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Models"}),e.value.map((function(e){return Object(r.jsx)(B,Object(k.a)({},e),e.name)}))]})}function B(e){return Object(r.jsx)(C.a,{header:Object(r.jsx)(o.b,{to:e.name,children:e.name}),shaded:!0,children:Object(r.jsxs)(T,{children:[Object(r.jsx)(P,{model:e.name,rnd:"",name:"error"}),Object(r.jsx)(P,{model:e.name,rnd:"",name:"direction"}),Object(r.jsx)(P,{model:e.name,rnd:"",name:"angle"}),Object(r.jsx)(P,{model:e.name,rnd:"",name:"loss"})]})})}function P(e){return Object(r.jsx)("img",{alt:"".concat(e.name," plot"),src:"/models/".concat(e.model,"/logs/").concat(e.name,".png?rnd=").concat(e.rnd)})}var U=n(65),J=n(427),z=n(428),G=n(28),V=n(422),W=n(415),Y=n(429),Z=n(423),q=n(425),K=n(430),Q=n(431);n(305);function X(e){return Object(r.jsx)("div",Object(k.a)({className:"button-bar"},e))}var $={};function ee(){var e=Object(c.useState)(void 0),t=Object(N.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(void 0),i=Object(N.a)(s,2),o=i[0],j=i[1],d=Object(c.useState)(void 0),l=Object(N.a)(d,2),u=l[0],b=l[1],h=Object(c.useState)(""),O=Object(N.a)(h,2),p=O[0],f=O[1],x=Object(c.useState)(0),m=Object(N.a)(x,2),g=m[0],y=m[1],S=Object(c.useRef)($);var E=A($,"getHyperparameters"),k=E.pending,F=E.value;return Object(c.useEffect)((function(){return w("training",(function(e){switch(e.event){case"started":a("active"),b(void 0);break;case"preview":y(Date.now());break;case"progress":j(Math.round(100*e.payload.epoch)),b(Math.round(100*e.payload.train));break;case"cancelled":a("fail");break;case"done":y(Date.now()),a("success"),f(e.payload.model)}}))}),[]),k?null:Object(r.jsxs)("div",{className:"trainPage",children:[Object(r.jsx)("h3",{children:"Model training"}),Object(r.jsxs)(C.a,{shaded:!0,header:"Hyperparameters",children:[Object(r.jsx)(J.a,{description:"You may have to tune the learning rate and batch size depending on your available compute resources and dataset. As a general rule of thumb, if you increase the batch size by a factor of n, you can increase the learning rate by a factor of sqrt(n)."}),Object(r.jsxs)(z.a,{onChange:function(e){Object.keys(e).forEach((function(t){var n=e[t];e[t]="string"===typeof n?Number(n):n})),console.log(e),S.current=e},formDefaultValue:F,layout:"horizontal",children:[Object(r.jsx)(ne,{name:"TRAIN_BATCH_SIZE",min:1}),Object(r.jsx)(ne,{name:"TEST_BATCH_SIZE",min:1}),Object(r.jsx)(ne,{name:"LEARNING_RATE",min:0,step:1e-4}),Object(r.jsx)(ne,{name:"NUM_EPOCHS",min:1,help:"For debugging and hyperparamter tuning, you can set the number of epochs to a small value like 10. If you want to train a model which will achieve good performance, you should set it to 50 or more. In our paper we used 100."}),Object(r.jsxs)(C.a,{bordered:!0,header:"Advanced parameters",collapsible:!0,children:[Object(r.jsx)(J.a,{type:"warning",description:"Don't change these unless you know what you are doing"}),Object(r.jsx)(ce,{name:"BATCH_NORM",defaultChecked:F.BATCH_NORM}),Object(r.jsx)(ce,{name:"FLIP_AUG",defaultChecked:F.FLIP_AUG}),Object(r.jsx)(ce,{name:"CMD_AUG",defaultChecked:F.CMD_AUG})]})]}),Object(r.jsxs)(X,{children:[Object(r.jsx)(G.a,{onClick:function(){return v("start",S.current)},appearance:"primary",children:"Start"}),Object(r.jsx)(G.a,{onClick:function(){return v("stop")},children:"Stop"})]})]}),!!u&&Object(r.jsxs)(C.a,{shaded:!0,header:"Progress",children:[Object(r.jsxs)("div",{children:["Current epoch:",Object(r.jsx)(V.a.Line,{percent:o})]}),Object(r.jsxs)("div",{children:["Training:",Object(r.jsx)(V.a.Line,{percent:u,status:n})]})]}),!!g&&Object(r.jsx)(C.a,{bodyFill:!0,shaded:!0,header:"Train preview",collapsible:!0,defaultExpanded:!0,children:Object(r.jsx)("img",{alt:"preview thumbnails",src:"/models/train_preview.png?rnd="+g})}),p&&Object(r.jsx)(C.a,{bodyFill:!0,shaded:!0,header:"Test preview",collapsible:!0,defaultExpanded:!0,children:Object(r.jsx)("img",{alt:"preview thumbnails",src:"/models/".concat(p,"/logs/test_preview.png?rnd=").concat(g)})}),p&&Object(r.jsxs)(T,{children:[Object(r.jsx)(te,{model:p,rnd:g,name:"error"}),Object(r.jsx)(te,{model:p,rnd:g,name:"direction"}),Object(r.jsx)(te,{model:p,rnd:g,name:"angle"}),Object(r.jsx)(te,{model:p,rnd:g,name:"loss"})]})]})}function te(e){return Object(r.jsx)(C.a,{bodyFill:!0,shaded:!0,children:Object(r.jsx)("img",{alt:"".concat(e.name," plot"),src:"/models/".concat(e.model,"/logs/").concat(e.name,".png?rnd=").concat(e.rnd)})})}function ne(e){var t=e.help,n=Object(U.a)(e,["help"]);return Object(r.jsxs)(W.a,{children:[Object(r.jsx)(Y.a,{children:n.name}),Object(r.jsx)(Z.a,Object(k.a)({accepter:q.a},n)),t&&Object(r.jsx)(K.a,{children:t})]})}function ce(e){return Object(r.jsxs)("div",{className:"bool-input",children:[Object(r.jsx)(Y.a,{children:e.name}),Object(r.jsx)(Z.a,Object(k.a)({accepter:Q.a},e))]})}var ae=n(432),re=n(420),se=n(419);function ie(e){var t=e.path,n=Object(U.a)(e,["path"]);return Object(r.jsxs)(se.a,Object(k.a)(Object(k.a)({backdrop:"static",size:"xs"},n),{},{children:[Object(r.jsx)(se.a.Header,{children:Object(r.jsx)(se.a.Title,{children:"Are you really want to delete this session?"})}),Object(r.jsx)(se.a.Body,{children:Object(r.jsx)("img",{src:"".concat(t,"/preview.gif"),alt:"preview"})}),Object(r.jsxs)(se.a.Footer,{children:[Object(r.jsx)(G.a,{onClick:function(){return function(e){v("deleteSession",{path:e})}(t)},appearance:"primary",children:"Yes"}),Object(r.jsx)(G.a,{onClick:n.onHide,appearance:"subtle",children:"No"})]})]}))}var oe=n(418);function je(e){var t=e.path,n=Object(U.a)(e,["path"]),a=function(e){return[{value:"uploaded",label:"uploaded"},{value:"train",label:"train",children:e.train.map((function(e){return{value:e.path,label:e.name}}))},{value:"test",label:"test",children:e.test.map((function(e){return{value:e.path,label:e.name}}))}]}(M().value),s=Object(c.useRef)("");return Object(r.jsx)(se.a,Object(k.a)(Object(k.a)({backdrop:"static",size:"xs"},n),{},{children:Object(r.jsxs)(z.a,{onSubmit:function(){v("moveSession",{path:t,new_path:s.current})},children:[Object(r.jsx)(se.a.Header,{children:Object(r.jsx)(se.a.Title,{children:"Move session"})}),Object(r.jsx)(se.a.Body,{children:Object(r.jsxs)(W.a,{children:[Object(r.jsx)(Y.a,{children:"To folder:"}),Object(r.jsx)(oe.a,{name:"new_path",data:a,defaultValue:"uploaded",defaultExpandAll:!0,disabledItemValues:["train","test"],onChange:function(e){console.log(e),s.current=e},block:!0})]})}),Object(r.jsxs)(se.a.Footer,{children:[Object(r.jsx)(G.a,{type:"submit",appearance:"primary",children:"Move"}),Object(r.jsx)(G.a,{onClick:n.onHide,appearance:"subtle",children:"Cancel"})]})]})}))}var de={basename:"",path:"",session:void 0,file_list:[]};function le(){var e=Object(j.g)();return Object(r.jsxs)(j.c,{children:[Object(r.jsx)(j.a,{path:e.url+"/:path",component:ue}),Object(r.jsx)(j.a,{component:be})]})}function ue(){var e=Object(j.f)().path,t=A(de,"listDir",{path:"uploaded/"+e}).value.session;return Object(r.jsxs)(C.a,{shaded:!0,children:[Object(r.jsx)("h3",{children:e}),t?Object(r.jsx)(he,Object(k.a)({},t)):Object(r.jsx)(ae.a,{})]})}function be(){var e=A(de,"listDir",{path:"uploaded"}),t=e.value,n=e.reload;return Object(c.useEffect)((function(){return w("session",n)}),[n]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Uploaded sessions"}),Object(r.jsxs)(T,{children:[!t.file_list.length&&Object(r.jsx)(C.a,{shaded:!0,children:"No sessions"}),t.file_list.map((function(e){return Object(r.jsx)(C.a,{bodyFill:!0,shaded:!0,children:Object(r.jsx)(he,Object(k.a)({},e))},e.path)}))]})]})}function he(e){var t=F(!1),n=Object(N.a)(t,2),c=n[0],a=n[1],s=F(!1),i=Object(N.a)(s,2),j=i[0],d=i[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("img",{src:"".concat(e.path,"/preview.gif"),alt:"preview"}),Object(r.jsxs)(C.a,{children:[Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(r.jsx)(o.b,{to:e.path,children:e.name}),Object(r.jsxs)(re.a,{title:"Actions",children:[Object(r.jsx)(re.a.Item,{onSelect:a,children:"Move..."}),Object(r.jsx)(re.a.Item,{onSelect:d,children:"Remove..."})]})]}),Object(r.jsxs)("div",{children:["Frames: ",e.frames]})]}),c&&Object(r.jsx)(je,{path:e.path,show:c,onHide:a}),Object(r.jsx)(ie,{path:e.path,show:j,onHide:d})]})}var Oe=function(){return Object(r.jsxs)(d.a,{className:"App",children:[Object(r.jsx)(l.a,{children:Object(r.jsxs)(u.a,{appearance:"inverse",children:[Object(r.jsx)(u.a.Header,{children:Object(r.jsx)("a",{href:"#/",className:"navbar-brand logo",children:"OpenBot Driving Policy Trainer"})}),Object(r.jsx)(u.a.Body,{children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(b.a.Item,{href:"#/",children:"Datasets"}),Object(r.jsx)(b.a.Item,{href:"#/models",children:"Models"}),Object(r.jsx)(b.a.Item,{href:"#/uploaded",children:"Uploaded"}),Object(r.jsx)(b.a.Item,{href:"#/train",children:"Train"})]})})]})}),Object(r.jsx)(h.a,{children:Object(r.jsxs)(j.c,{children:[Object(r.jsx)(j.a,{path:"/models",children:Object(r.jsx)(R,{})}),Object(r.jsx)(j.a,{path:"/uploaded",children:Object(r.jsx)(le,{})}),Object(r.jsx)(j.a,{path:"/train",children:Object(r.jsx)(ee,{})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(H,{})})]})}),Object(r.jsx)(E,{})]})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,436)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(o.a,{children:Object(r.jsx)(Oe,{})})}),document.getElementById("root")),pe()}},[[411,1,2]]]);
//# sourceMappingURL=main.3c1f1480.chunk.js.map
Metadata-Version: 2.1
Name: daemon-loop
Version: 0.0.1
Summary: simple CLI utility to run other programs periodically as daemon without cron
Home-page: https://github.com/yaroslaff/daemon-loop
Author: Yaroslav Polyakov
Author-email: yaroslaff@gmail.com
License: MIT
Platform: UNKNOWN
Description-Content-Type: text/markdown
Requires-Dist: python-daemon

# Daemon Loop
Daemon loop is simple and clean CLI utility to run programs periodically.

It's better alternative to running commands like:
~~~shell
while true; do date >> date.log; sleep 5; done 
~~~
(or even running such commands in screen/tmux sessions)

## Installation
~~~
pip3 install daemon-loop
~~~

## Usage
~~~
usage: loop [-h] [-n N] [-p PERIOD] [--log FILENAME] [--err] [-v] [-d]
            command [command ...]

Run command in loop (with features)

positional arguments:
  command               command (maybe in quotes, e.g "ls -l")

optional arguments:
  -h, --help            show this help message and exit
  -n N                  Run N times and exit (default: 0 = infinite)
  -p PERIOD, --period PERIOD
                        Run every N seconds (default: 60)
  --log FILENAME        Write command stdout to this file
  -e, --err             Write command stderr to logfile)
  -v, --verbose         Write loop technical info to logfile)
  -d, --daemon          Work as daemon
~~~

## Example usage
Simple and almost useless - run `date` every second until Ctrl-C:
~~~shell
$ loop date
Sun Dec 20 05:18:21 +07 2020
Sun Dec 20 05:19:21 +07 2020
Sun Dec 20 05:20:21 +07 2020
^C
~~~

Run `date +%s` (print unixtime) 3 times every 10 seconds and quit
~~~shell
$ loop -p 10 -n 3 -- date +%s
1608416485
1608416495
1608416505
~~~

And now something more useful - make our `date` program a daemon!
~~~shell
$ loop -d -v -p 10 --log /tmp/x.log --err  -- date +%s 
$ pidof -x loop
24684
~~~

- `-d`: run as daemon
- `-p`: period is 10 seconds
- `--log`: logfile
- `--err`: include stderr to logfile
- `-v`: include technical info about time of start/stop, status code and daemon pid 

log file will look like this:
~~~
# 2020-12-20 05:32:52 my pid: 25464 run: date +%s
1608417172
# 2020-12-20 05:32:52 finished with status 0

# 2020-12-20 05:33:02 my pid: 25464 run: date +%s
1608417182
# 2020-12-20 05:33:02 finished with status 0
~~~ 



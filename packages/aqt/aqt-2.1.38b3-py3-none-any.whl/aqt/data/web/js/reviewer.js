"use strict";
/* Copyright: Ankitects Pty Ltd and contributors
 * License: GNU AGPL, version 3 or later; http://www.gnu.org/licenses/agpl.html */
var ankiPlatform = "desktop";
var typeans;
var _updatingQA = false;
var qFade = 100;
var aFade = 0;
var onUpdateHook;
var onShownHook;
function _runHook(arr) {
    var promises = [];
    for (var i = 0; i < arr.length; i++) {
        promises.push(arr[i]());
    }
    return Promise.all(promises);
}
function _updateQA(html, fadeTime, onupdate, onshown) {
    // if a request to update q/a comes in before the previous content
    // has been loaded, wait a while and try again
    if (_updatingQA) {
        setTimeout(function () {
            _updateQA(html, fadeTime, onupdate, onshown);
        }, 50);
        return;
    }
    _updatingQA = true;
    onUpdateHook = [onupdate];
    onShownHook = [onshown];
    var qa = $("#qa");
    // fade out current text
    new Promise((resolve) => qa.fadeTo(fadeTime, 0, () => resolve()))
        // update text
        .then(() => {
        try {
            qa.html(html);
        }
        catch (err) {
            qa.html((`Invalid HTML on card: ${String(err).substring(0, 2000)}\n` +
                String(err.stack).substring(0, 2000)).replace(/\n/g, "<br />"));
        }
    })
        .then(() => _runHook(onUpdateHook))
        .then(() => 
    // @ts-ignore wait for mathjax to ready
    MathJax.startup.promise.then(() => {
        // @ts-ignore clear MathJax buffer
        MathJax.typesetClear();
        // @ts-ignore typeset
        return MathJax.typesetPromise(qa.slice(0, 1));
    }))
        // and reveal when processing is done
        .then(() => new Promise((resolve) => qa.fadeTo(fadeTime, 1, () => resolve())))
        .then(() => _runHook(onShownHook))
        .then(() => (_updatingQA = false));
}
function _showQuestion(q, bodyclass) {
    _updateQA(q, qFade, function () {
        // return to top of window
        window.scrollTo(0, 0);
        document.body.className = bodyclass;
    }, function () {
        // focus typing area if visible
        typeans = document.getElementById("typeans");
        if (typeans) {
            typeans.focus();
        }
    });
}
function _showAnswer(a, bodyclass) {
    _updateQA(a, aFade, function () {
        if (bodyclass) {
            //  when previewing
            document.body.className = bodyclass;
        }
        // scroll to answer?
        var e = $("#answer");
        if (e[0]) {
            e[0].scrollIntoView();
        }
    }, function () { });
}
const _flagColours = {
    1: "#ff6666",
    2: "#ff9900",
    3: "#77ff77",
    4: "#77aaff",
};
function _drawFlag(flag) {
    var elem = $("#_flag");
    if (flag === 0) {
        elem.hide();
        return;
    }
    elem.show();
    elem.css("color", _flagColours[flag]);
}
function _drawMark(mark) {
    var elem = $("#_mark");
    if (!mark) {
        elem.hide();
    }
    else {
        elem.show();
    }
}
function _typeAnsPress() {
    if (window.event.keyCode === 13) {
        pycmd("ans");
    }
}
function _emulateMobile(enabled) {
    const list = document.documentElement.classList;
    if (enabled) {
        list.add("mobile");
    }
    else {
        list.remove("mobile");
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmV2aWV3ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9xdC9hcXQvZGF0YS93ZWIvanMvcmV2aWV3ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO2tGQUNrRjtBQUVsRixJQUFJLFlBQVksR0FBRyxTQUFTLENBQUM7QUFDN0IsSUFBSSxPQUFPLENBQUM7QUFDWixJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7QUFFeEIsSUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFDO0FBQ2hCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztBQUVkLElBQUksWUFBWSxDQUFDO0FBQ2pCLElBQUksV0FBVyxDQUFDO0FBRWhCLFNBQVMsUUFBUSxDQUFDLEdBQXlCO0lBQ3ZDLElBQUksUUFBUSxHQUFHLEVBQUUsQ0FBQztJQUVsQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNqQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDM0I7SUFFRCxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDakMsQ0FBQztBQUVELFNBQVMsU0FBUyxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLE9BQU87SUFDaEQsa0VBQWtFO0lBQ2xFLDhDQUE4QztJQUM5QyxJQUFJLFdBQVcsRUFBRTtRQUNiLFVBQVUsQ0FBQztZQUNQLFNBQVMsQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNqRCxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDUCxPQUFPO0tBQ1Y7SUFFRCxXQUFXLEdBQUcsSUFBSSxDQUFDO0lBRW5CLFlBQVksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzFCLFdBQVcsR0FB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S0FDekI7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyogQ29weXJpZ2h0OiBBbmtpdGVjdHMgUHR5IEx0ZCBhbmQgY29udHJpYnV0b3JzXG4gKiBMaWNlbnNlOiBHTlUgQUdQTCwgdmVyc2lvbiAzIG9yIGxhdGVyOyBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC5odG1sICovXG5cbnZhciBhbmtpUGxhdGZvcm0gPSBcImRlc2t0b3BcIjtcbnZhciB0eXBlYW5zO1xudmFyIF91cGRhdGluZ1FBID0gZmFsc2U7XG5cbnZhciBxRmFkZSA9IDEwMDtcbnZhciBhRmFkZSA9IDA7XG5cbnZhciBvblVwZGF0ZUhvb2s7XG52YXIgb25TaG93bkhvb2s7XG5cbmZ1bmN0aW9uIF9ydW5Ib29rKGFycjogKCkgPT4gUHJvbWlzZTxhbnk+W10pOiBQcm9taXNlPGFueVtdPiB7XG4gICAgdmFyIHByb21pc2VzID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICBwcm9taXNlcy5wdXNoKGFycltpXSgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xufVxuXG5mdW5jdGlvbiBfdXBkYXRlUUEoaHRtbCwgZmFkZVRpbWUsIG9udXBkYXRlLCBvbnNob3duKSB7XG4gICAgLy8gaWYgYSByZXF1ZXN0IHRvIHVwZGF0ZSBxL2EgY29tZXMgaW4gYmVmb3JlIHRoZSBwcmV2aW91cyBjb250ZW50XG4gICAgLy8gaGFzIGJlZW4gbG9hZGVkLCB3YWl0IGEgd2hpbGUgYW5kIHRyeSBhZ2FpblxuICAgIGlmIChfdXBkYXRpbmdRQSkge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF91cGRhdGVRQShodG1sLCBmYWRlVGltZSwgb251cGRhdGUsIG9uc2hvd24pO1xuICAgICAgICB9LCA1MCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBfdXBkYXRpbmdRQSA9IHRydWU7XG5cbiAgICBvblVwZGF0ZUhvb2sgPSBbb251cGRhdGVdO1xuICAgIG9uU2hvd25Ib29rID0gW29uc2hvd25dO1xuXG4gICAgdmFyIHFhID0gJChcIiNxYVwiKTtcblxuICAgIC8vIGZhZGUgb3V0IGN1cnJlbnQgdGV4dFxuICAgIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBxYS5mYWRlVG8oZmFkZVRpbWUsIDAsICgpID0+IHJlc29sdmUoKSkpXG4gICAgICAgIC8vIHVwZGF0ZSB0ZXh0XG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcWEuaHRtbChodG1sKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHFhLmh0bWwoXG4gICAgICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGBJbnZhbGlkIEhUTUwgb24gY2FyZDogJHtTdHJpbmcoZXJyKS5zdWJzdHJpbmcoMCwgMjAwMCl9XFxuYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcoZXJyLnN0YWNrKS5zdWJzdHJpbmcoMCwgMjAwMClcbiAgICAgICAgICAgICAgICAgICAgKS5yZXBsYWNlKC9cXG4vZywgXCI8YnIgLz5cIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigoKSA9PiBfcnVuSG9vayhvblVwZGF0ZUhvb2spKVxuICAgICAgICAudGhlbigoKSA9PlxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB3YWl0IGZvciBtYXRoamF4IHRvIHJlYWR5XG4gICAgICAgICAgICBNYXRoSmF4LnN0YXJ0dXAucHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIGNsZWFyIE1hdGhKYXggYnVmZmVyXG4gICAgICAgICAgICAgICAgTWF0aEpheC50eXBlc2V0Q2xlYXIoKTtcblxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdHlwZXNldFxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoSmF4LnR5cGVzZXRQcm9taXNlKHFhLnNsaWNlKDAsIDEpKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICAgLy8gYW5kIHJldmVhbCB3aGVuIHByb2Nlc3NpbmcgaXMgZG9uZVxuICAgICAgICAudGhlbigoKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcWEuZmFkZVRvKGZhZGVUaW1lLCAxLCAoKSA9PiByZXNvbHZlKCkpKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gX3J1bkhvb2sob25TaG93bkhvb2spKVxuICAgICAgICAudGhlbigoKSA9PiAoX3VwZGF0aW5nUUEgPSBmYWxzZSkpO1xufVxuXG5mdW5jdGlvbiBfc2hvd1F1ZXN0aW9uKHEsIGJvZHljbGFzcykge1xuICAgIF91cGRhdGVRQShcbiAgICAgICAgcSxcbiAgICAgICAgcUZhZGUsXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHJldHVybiB0byB0b3Agb2Ygd2luZG93XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG5cbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NOYW1lID0gYm9keWNsYXNzO1xuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBmb2N1cyB0eXBpbmcgYXJlYSBpZiB2aXNpYmxlXG4gICAgICAgICAgICB0eXBlYW5zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0eXBlYW5zXCIpO1xuICAgICAgICAgICAgaWYgKHR5cGVhbnMpIHtcbiAgICAgICAgICAgICAgICB0eXBlYW5zLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICApO1xufVxuXG5mdW5jdGlvbiBfc2hvd0Fuc3dlcihhLCBib2R5Y2xhc3MpIHtcbiAgICBfdXBkYXRlUUEoXG4gICAgICAgIGEsXG4gICAgICAgIGFGYWRlLFxuICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoYm9keWNsYXNzKSB7XG4gICAgICAgICAgICAgICAgLy8gIHdoZW4gcHJldmlld2luZ1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NOYW1lID0gYm9keWNsYXNzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzY3JvbGwgdG8gYW5zd2VyP1xuICAgICAgICAgICAgdmFyIGUgPSAkKFwiI2Fuc3dlclwiKTtcbiAgICAgICAgICAgIGlmIChlWzBdKSB7XG4gICAgICAgICAgICAgICAgZVswXS5zY3JvbGxJbnRvVmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAoKSB7fVxuICAgICk7XG59XG5cbmNvbnN0IF9mbGFnQ29sb3VycyA9IHtcbiAgICAxOiBcIiNmZjY2NjZcIixcbiAgICAyOiBcIiNmZjk5MDBcIixcbiAgICAzOiBcIiM3N2ZmNzdcIixcbiAgICA0OiBcIiM3N2FhZmZcIixcbn07XG5cbmZ1bmN0aW9uIF9kcmF3RmxhZyhmbGFnKSB7XG4gICAgdmFyIGVsZW0gPSAkKFwiI19mbGFnXCIpO1xuICAgIGlmIChmbGFnID09PSAwKSB7XG4gICAgICAgIGVsZW0uaGlkZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsZW0uc2hvdygpO1xuICAgIGVsZW0uY3NzKFwiY29sb3JcIiwgX2ZsYWdDb2xvdXJzW2ZsYWddKTtcbn1cblxuZnVuY3Rpb24gX2RyYXdNYXJrKG1hcmspIHtcbiAgICB2YXIgZWxlbSA9ICQoXCIjX21hcmtcIik7XG4gICAgaWYgKCFtYXJrKSB7XG4gICAgICAgIGVsZW0uaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW0uc2hvdygpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX3R5cGVBbnNQcmVzcygpIHtcbiAgICBpZiAoKHdpbmRvdy5ldmVudCBhcyBLZXlib2FyZEV2ZW50KS5rZXlDb2RlID09PSAxMykge1xuICAgICAgICBweWNtZChcImFuc1wiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIF9lbXVsYXRlTW9iaWxlKGVuYWJsZWQ6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdDtcbiAgICBpZiAoZW5hYmxlZCkge1xuICAgICAgICBsaXN0LmFkZChcIm1vYmlsZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsaXN0LnJlbW92ZShcIm1vYmlsZVwiKTtcbiAgICB9XG59XG4iXX0=

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tlslite.utils.rsakey module &#8212; tlslite-ng 0.7.6 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-tlslite.utils.rsakey">
<span id="tlslite-utils-rsakey-module"></span><h1>tlslite.utils.rsakey module<a class="headerlink" href="#module-tlslite.utils.rsakey" title="Permalink to this headline">¶</a></h1>
<p>Abstract class for RSA.</p>
<dl class="class">
<dt id="tlslite.utils.rsakey.RSAKey">
<em class="property">class </em><code class="sig-prename descclassname">tlslite.utils.rsakey.</code><code class="sig-name descname">RSAKey</code><span class="sig-paren">(</span><em class="sig-param">n=0</em>, <em class="sig-param">e=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is an abstract base class for RSA keys.</p>
<p>Particular implementations of RSA keys, such as
<a class="reference internal" href="tlslite.utils.openssl_rsakey.html#tlslite.utils.openssl_rsakey.OpenSSL_RSAKey" title="tlslite.utils.openssl_rsakey.OpenSSL_RSAKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpenSSL_RSAKey</span></code></a>,
<a class="reference internal" href="tlslite.utils.python_rsakey.html#tlslite.utils.python_rsakey.Python_RSAKey" title="tlslite.utils.python_rsakey.Python_RSAKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">Python_RSAKey</span></code></a>, and
<a class="reference internal" href="tlslite.utils.pycrypto_rsakey.html#tlslite.utils.pycrypto_rsakey.PyCrypto_RSAKey" title="tlslite.utils.pycrypto_rsakey.PyCrypto_RSAKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyCrypto_RSAKey</span></code></a>,
inherit from this.</p>
<p>To create or parse an RSA key, don’t use one of these classes
directly.  Instead, use the factory functions in
<a class="reference internal" href="tlslite.utils.keyfactory.html#module-tlslite.utils.keyfactory" title="tlslite.utils.keyfactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">keyfactory</span></code></a>.</p>
<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.EMSA_PSS_encode">
<code class="sig-name descname">EMSA_PSS_encode</code><span class="sig-paren">(</span><em class="sig-param">mHash</em>, <em class="sig-param">emBits</em>, <em class="sig-param">hAlg</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.EMSA_PSS_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the passed in message</p>
<p>This encodes the message using selected hash algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mHash</strong> (<em>bytearray</em>) – Hash of message to be encoded</p></li>
<li><p><strong>emBits</strong> (<em>int</em>) – maximal length of returned EM</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – hash algorithm to be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – length of salt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.EMSA_PSS_verify">
<code class="sig-name descname">EMSA_PSS_verify</code><span class="sig-paren">(</span><em class="sig-param">mHash</em>, <em class="sig-param">EM</em>, <em class="sig-param">emBits</em>, <em class="sig-param">hAlg</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.EMSA_PSS_verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify signature in passed in encoded message</p>
<p>This verifies the signature in encoded message</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mHash</strong> (<em>bytearray</em>) – Hash of the original not signed message</p></li>
<li><p><strong>EM</strong> (<em>bytearray</em>) – Encoded message</p></li>
<li><p><strong>emBits</strong> (<em>int</em>) – Length of the encoded message in bits</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – hash algorithm to be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – Length of salt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.MGF1">
<code class="sig-name descname">MGF1</code><span class="sig-paren">(</span><em class="sig-param">mgfSeed</em>, <em class="sig-param">maskLen</em>, <em class="sig-param">hAlg</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.MGF1" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate mask from passed-in seed.</p>
<p>This generates mask based on passed-in seed and output maskLen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mgfSeed</strong> (<em>bytearray</em>) – Seed from which mask will be generated.</p></li>
<li><p><strong>maskLen</strong> (<em>int</em>) – Wished length of the mask, in octets</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytearray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mask</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.RSASSA_PSS_sign">
<code class="sig-name descname">RSASSA_PSS_sign</code><span class="sig-paren">(</span><em class="sig-param">mHash</em>, <em class="sig-param">hAlg</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.RSASSA_PSS_sign" title="Permalink to this definition">¶</a></dt>
<dd><p>“Sign the passed in message</p>
<p>This signs the message using selected hash algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mHash</strong> (<em>bytearray</em>) – Hash of message to be signed</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – hash algorithm to be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – length of salt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.RSASSA_PSS_verify">
<code class="sig-name descname">RSASSA_PSS_verify</code><span class="sig-paren">(</span><em class="sig-param">mHash</em>, <em class="sig-param">S</em>, <em class="sig-param">hAlg</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.RSASSA_PSS_verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify the signature in passed in message</p>
<p>This verifies the signature in the signed message</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mHash</strong> (<em>bytearray</em>) – Hash of original message</p></li>
<li><p><strong>S</strong> (<em>bytearray</em>) – Signed message</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – Hash algorithm to be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – Length of salt</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">n=0</em>, <em class="sig-param">e=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new RSA key.</p>
<p>If n and e are passed in, the new key will be initialized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – RSA modulus.</p></li>
<li><p><strong>e</strong> (<em>int</em>) – RSA public exponent.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.acceptsPassword">
<code class="sig-name descname">acceptsPassword</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.acceptsPassword" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the write() method accepts a password for use
in encrypting the private key.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.addPKCS1Prefix">
<em class="property">classmethod </em><code class="sig-name descname">addPKCS1Prefix</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">hashName</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.addPKCS1Prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the PKCS#1 v1.5 algorithm identifier prefix to hash bytes</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.addPKCS1SHA1Prefix">
<em class="property">classmethod </em><code class="sig-name descname">addPKCS1SHA1Prefix</code><span class="sig-paren">(</span><em class="sig-param">hashBytes</em>, <em class="sig-param">withNULL=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.addPKCS1SHA1Prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Add PKCS#1 v1.5 algorithm identifier prefix to SHA1 hash bytes</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.decrypt">
<code class="sig-name descname">decrypt</code><span class="sig-paren">(</span><em class="sig-param">encBytes</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the passed-in bytes.</p>
<p>This requires the key to have a private component.  It performs
PKCS#1 v1.5 decryption operation of the passed-in data.</p>
<p>Note: as a workaround against Bleichenbacher-like attacks, it will
return a deterministically selected random message in case the padding
checks failed. It returns an error (None) only in case the ciphertext
is of incorrect length or encodes an integer bigger than the modulus
of the key (i.e. it’s publically invalid).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>encBytes</strong> (<em>bytearray</em>) – The value which will be decrypted.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytearray or None</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A PKCS#1 v1.5 decryption of the passed-in data or None if
the provided data is not properly formatted. Note: encrypting
an empty string is correct, so it may return an empty bytearray
for some ciphertexts.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.encrypt">
<code class="sig-name descname">encrypt</code><span class="sig-paren">(</span><em class="sig-param">bytes</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the passed-in bytes.</p>
<p>This performs PKCS1 encryption of the passed-in data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bytes</strong> (<em>bytearray</em>) – The value which will be encrypted.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytearray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A PKCS1 encryption of the passed-in data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.generate">
<em class="property">static </em><code class="sig-name descname">generate</code><span class="sig-paren">(</span><em class="sig-param">bits</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a new key with the specified bit length.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>RSAKey</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.hasPrivateKey">
<code class="sig-name descname">hasPrivateKey</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.hasPrivateKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether or not this key has a private component.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.hashAndSign">
<code class="sig-name descname">hashAndSign</code><span class="sig-paren">(</span><em class="sig-param">bytes</em>, <em class="sig-param">rsaScheme='PKCS1'</em>, <em class="sig-param">hAlg='sha1'</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.hashAndSign" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash and sign the passed-in bytes.</p>
<p>This requires the key to have a private component.  It performs
a PKCS1 or PSS signature on the passed-in data with selected hash
algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> (<em>str</em><em> or </em><em>bytearray</em>) – The value which will be hashed and signed.</p></li>
<li><p><strong>rsaScheme</strong> (<em>str</em>) – The type of RSA scheme that will be applied,
“PKCS1” for RSASSA-PKCS#1 v1.5 signature and “PSS”
for RSASSA-PSS with MGF1 signature method</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – The hash algorithm that will be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – The length of intended salt value, applicable only
for RSASSA-PSS signatures</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytearray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A PKCS1 or PSS signature on the passed-in data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.hashAndVerify">
<code class="sig-name descname">hashAndVerify</code><span class="sig-paren">(</span><em class="sig-param">sigBytes</em>, <em class="sig-param">bytes</em>, <em class="sig-param">rsaScheme='PKCS1'</em>, <em class="sig-param">hAlg='sha1'</em>, <em class="sig-param">sLen=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.hashAndVerify" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash and verify the passed-in bytes with the signature.</p>
<p>This verifies a PKCS1 or PSS signature on the passed-in data
with selected hash algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigBytes</strong> (<em>bytearray</em>) – A PKCS1 or PSS signature.</p></li>
<li><p><strong>bytes</strong> (<em>str</em><em> or </em><em>bytearray</em>) – The value which will be hashed and verified.</p></li>
<li><p><strong>rsaScheme</strong> (<em>str</em>) – The type of RSA scheme that will be applied,
“PKCS1” for RSASSA-PKCS#1 v1.5 signature and “PSS”
for RSASSA-PSS with MGF1 signature method</p></li>
<li><p><strong>hAlg</strong> (<em>str</em>) – The hash algorithm that will be used</p></li>
<li><p><strong>sLen</strong> (<em>int</em>) – The length of intended salt value, applicable only
for RSASSA-PSS signatures</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the signature matches the passed-in data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.sign">
<code class="sig-name descname">sign</code><span class="sig-paren">(</span><em class="sig-param">bytes</em>, <em class="sig-param">padding='pkcs1'</em>, <em class="sig-param">hashAlg=None</em>, <em class="sig-param">saltLen=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign the passed-in bytes.</p>
<p>This requires the key to have a private component.  It performs
a PKCS1 signature on the passed-in data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bytes</strong> (<em>bytearray</em>) – The value which will be signed.</p></li>
<li><p><strong>padding</strong> (<em>str</em>) – name of the rsa padding mode to use, supported:
“pkcs1” for RSASSA-PKCS1_1_5 and “pss” for RSASSA-PSS.</p></li>
<li><p><strong>hashAlg</strong> (<em>str</em>) – name of hash to be encoded using the PKCS#1 prefix
for “pkcs1” padding or the hash used for MGF1 in “pss”. Parameter
is mandatory for “pss” padding.</p></li>
<li><p><strong>saltLen</strong> (<em>int</em>) – length of salt used for the PSS padding. Default
is the length of the hash output used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bytearray</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A PKCS1 signature on the passed-in data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.verify">
<code class="sig-name descname">verify</code><span class="sig-paren">(</span><em class="sig-param">sigBytes</em>, <em class="sig-param">bytes</em>, <em class="sig-param">padding='pkcs1'</em>, <em class="sig-param">hashAlg=None</em>, <em class="sig-param">saltLen=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.verify" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify the passed-in bytes with the signature.</p>
<p>This verifies a PKCS1 signature on the passed-in data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigBytes</strong> (<em>bytearray</em>) – A PKCS1 signature.</p></li>
<li><p><strong>bytes</strong> (<em>bytearray</em>) – The value which will be verified.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the signature matches the passed-in data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tlslite.utils.rsakey.RSAKey.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">password=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.utils.rsakey.RSAKey.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string containing the key.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A string describing the key, in whichever format (PEM)
is native to the implementation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">tlslite-ng</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Hubert Kario.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tlslite.utils.rsakey.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
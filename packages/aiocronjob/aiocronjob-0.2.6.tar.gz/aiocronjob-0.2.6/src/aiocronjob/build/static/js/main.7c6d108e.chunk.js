(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[0],{162:function(t,e,n){"use strict";n.r(e);var s=n(10),o=n(0),c=n.n(o),a=n(9),i=n.n(a),r=(n(89),n(90),n(76)),l=n(77),h=n(43),j=n(83),b=n(82),u=(n(91),n(12)),d=function(t){Object(j.a)(n,t);var e=Object(b.a)(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this,t)).state={jobs:[]},o.showActionSheet=function(t){var e,c=[];"running"===t.last_status?(e="cancel",c.push("Stop job")):(e="start",c.push("Start job")),c.push("Cancel"),u.a.showActionSheetWithOptions({options:c,cancelButtonIndex:c.length-1,title:Object(s.jsxs)("span",{children:[t.name," ",n.getStatusBadge(t.last_status)]}),message:Object(s.jsxs)("span",{children:["\ud83d\udd53 ",t.crontab]}),maskClosable:!0},(function(n){0===n&&o.doAction(t.name,e).then(o.handleRefresh).catch((function(t){console.error("oops",t)}))}))},o.handleRefresh=o.handleRefresh.bind(Object(h.a)(o)),o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.handleRefresh()}},{key:"handleRefresh",value:function(){var t=this;fetch("".concat("","/api/jobs")).then((function(t){return t.json()})).then((function(e){console.log(e),t.setState({jobs:e})})).catch((function(t){u.g.offline("".concat(t),3)}))}},{key:"doAction",value:function(t,e){return fetch("".concat("","/api/jobs/").concat(t,"/").concat(e))}},{key:"render",value:function(){var t=this,e=this.state.jobs.filter((function(t){return"error"===t.last_status})),o=this.state.jobs.filter((function(t){return"done"===t.last_status})),c=this.state.jobs.filter((function(t){return"running"===t.last_status})),a=[{title:Object(s.jsx)(u.b,{text:this.state.jobs.length,children:"All"})},{title:Object(s.jsx)(u.b,{text:c.length,children:"Running"})},{title:Object(s.jsx)(u.b,{text:e.length,children:"Error"})},{title:Object(s.jsx)(u.b,{text:o.length,children:"Done"})}],i=function(e){return Object(s.jsx)(u.d,{children:e.map((function(e){return Object(s.jsx)(u.d.Item,{arrow:"horizontal",onClick:function(){return t.showActionSheet(e)},children:Object(s.jsxs)("span",{children:[e.name,n.getStatusBadge(e.last_status)]})},e.name)}))})};return[Object(s.jsx)(u.e,{mode:"light",rightContent:Object(s.jsx)(u.c,{icon:Object(s.jsx)("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/jBfVSpDwPbitsABtDDlB.svg",alt:""}),inline:!0,size:"small",onClick:this.handleRefresh,children:"Refresh"}),children:"Aiocronjob"},"navbar"),Object(s.jsxs)(u.f,{tabs:a,initialPage:1,onChange:function(t,e){console.log("onChange",e,t)},onTabClick:function(t,e){console.log("onTabClick",e,t)},children:[Object(s.jsx)("div",{style:{height:"100%"},children:0===this.state.jobs.length?Object(s.jsx)("span",{children:"No jobs."}):i(this.state.jobs)}),Object(s.jsx)("div",{style:{height:"100%"},children:0===c.length?Object(s.jsx)("span",{style:{margin:"auto"},children:"No running jobs."}):i(c)}),Object(s.jsx)("div",{style:{height:"100%"},children:0===e.length?Object(s.jsx)("span",{children:"No error jobs."}):i(e)}),Object(s.jsx)("div",{style:{height:"100%"},children:0===o.length?Object(s.jsx)("span",{children:"No done jobs."}):i(o)})]},"tabs")]}}],[{key:"getStatusBadge",value:function(t){var e;switch(t){case"pending":e="orange";break;case"running":e="green";break;case"done":e="#000";break;case"error":e="red";break;default:e="grey"}return Object(s.jsx)(u.b,{text:t,style:{marginLeft:12,padding:"0 3px",backgroundColor:"#fff",borderRadius:2,color:e,border:"1px solid ".concat(e)}})}}]),n}(c.a.Component);var g=function(){return Object(s.jsx)("div",{className:"App",children:Object(s.jsx)(d,{})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(g,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},90:function(t,e,n){},91:function(t,e,n){}},[[162,1,2]]]);
//# sourceMappingURL=main.7c6d108e.chunk.js.map
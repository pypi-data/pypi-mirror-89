

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2.3. Functional examples &mdash; Nvector 0.7.6 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.4. What to read next" href="whatsnext.html" />
    <link rel="prev" title="2.2. Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Nvector
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">2.1. Install guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">2.2. Getting Started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.3. Functional examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1-a-and-b-to-delta">2.3.1. <strong>Example 1: “A and B to delta”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-b-and-delta-to-c">2.3.2. <strong>Example 2: “B and delta to C”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-3-ecef-vector-to-geodetic-latitude">2.3.3. <strong>Example 3: “ECEF-vector to geodetic latitude”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-4-geodetic-latitude-to-ecef-vector">2.3.4. <strong>Example 4: “Geodetic latitude to ECEF-vector”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-5-surface-distance">2.3.5. <strong>Example 5: “Surface distance”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-6-interpolated-position">2.3.6. <strong>Example 6 “Interpolated position”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-7-mean-position">2.3.7. <strong>Example 7: “Mean position”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-8-a-and-azimuth-distance-to-b">2.3.8. <strong>Example 8: “A and azimuth/distance to B”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-9-intersection-of-two-paths">2.3.9. <strong>Example 9: “Intersection of two paths”</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-10-cross-track-distance">2.3.10. <strong>Example 10: “Cross track distance”</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="whatsnext.html">2.4. What to read next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/index.html">3. How-to guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topics/index.html">4. Topics guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">5. Reference nvector package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/authors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/acknowledgement.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/zreferences.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nvector</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">2. </span>Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">2.3. </span>Functional examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/getting_started_functional.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-nvector._info_functional"></span><div class="section" id="functional-examples">
<h1><span class="section-number">2.3. </span>Functional examples<a class="headerlink" href="#functional-examples" title="Permalink to this headline">¶</a></h1>
<p>Below the functional solution to some common geodesic problems are given.
In the first example the object-oriented solution is also given.
The object-oriented solutions to the remaining problems can be found in
the <a class="reference internal" href="getting_started.html"><span class="doc">getting started</span></a> section of the tutorial.</p>
<div class="section" id="example-1-a-and-b-to-delta">
<h2><span class="section-number">2.3.1. </span><strong>Example 1: “A and B to delta”</strong><a class="headerlink" href="#example-1-a-and-b-to-delta" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex1img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex1img.png" />
<p>Given two positions, A and B as latitudes, longitudes and depths relative to
Earth, E.</p>
<p>Find the exact vector between the two positions, given in meters north, east,
and down, and find the direction (azimuth) to B, relative to north.
Assume WGS-84 ellipsoid. The given depths are from the ellipsoid surface.
Use position A to define north, east, and down directions.
(Due to the curvature of Earth and different directions to the North Pole,
the north, east, and down directions will change (relative to Earth) for
different places.  A must be outside the poles for the north and east
directions to be defined.)</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EA</span><span class="p">,</span> <span class="n">lon_EA</span><span class="p">,</span> <span class="n">z_EA</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span><span class="p">,</span> <span class="n">z_EB</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">6</span>
</pre></div>
</div>
</dd>
<dt>Step1: Convert to n-vectors:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">lat_EA</span><span class="p">,</span> <span class="n">lon_EA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step2: Find p_AB_E (delta decomposed in E).WGS-84 ellipsoid is default:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_AB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_EA_E_and_n_EB_E2p_AB_E</span><span class="p">(</span><span class="n">n_EA_E</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">z_EA</span><span class="p">,</span> <span class="n">z_EB</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step3: Find R_EN for position A:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R_EN</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2R_EN</span><span class="p">(</span><span class="n">n_EA_E</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step4: Find p_AB_N (delta decomposed in N).</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_AB_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R_EN</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">p_AB_E</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valtxt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:8.2f}</span><span class="s1">, </span><span class="si">{1:8.2f}</span><span class="s1">, </span><span class="si">{2:8.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">p_AB_N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;Ex1: delta north, east, down = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">valtxt</span><span class="p">)</span>
<span class="go">&#39;Ex1: delta north, east, down = 331730.23, 332997.87, 17404.27&#39;</span>
</pre></div>
</div>
</dd>
<dt>Step5: Also find the direction (azimuth) to B, relative to north:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">azimuth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">p_AB_N</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p_AB_N</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;azimuth = </span><span class="si">{0:4.2f}</span><span class="s1"> deg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="n">azimuth</span><span class="p">))</span>
<span class="go">&#39;azimuth = 45.11 deg&#39;</span>
</pre></div>
</div>
</dd>
<dt>OO-Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wgs84</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">FrameE</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;WGS84&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pointA</span> <span class="o">=</span> <span class="n">wgs84</span><span class="o">.</span><span class="n">GeoPoint</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pointB</span> <span class="o">=</span> <span class="n">wgs84</span><span class="o">.</span><span class="n">GeoPoint</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step1:  Find p_AB_N (delta decomposed in N).</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_AB_N</span> <span class="o">=</span> <span class="n">pointA</span><span class="o">.</span><span class="n">delta_to</span><span class="p">(</span><span class="n">pointB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">p_AB_N</span><span class="o">.</span><span class="n">pvector</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">valtxt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:8.2f}</span><span class="s1">, </span><span class="si">{1:8.2f}</span><span class="s1">, </span><span class="si">{2:8.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;Ex1: delta north, east, down = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">valtxt</span><span class="p">)</span>
<span class="go">&#39;Ex1: delta north, east, down = 331730.23, 332997.87, 17404.27&#39;</span>
</pre></div>
</div>
</dd>
<dt>Step2: Also find the direction (azimuth) to B, relative to north:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">azimuth</span> <span class="o">=</span> <span class="n">p_AB_N</span><span class="o">.</span><span class="n">azimuth_deg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;azimuth = </span><span class="si">{0:4.2f}</span><span class="s1"> deg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span>
<span class="go">&#39;azimuth = 45.11 deg&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_1">Example 1 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-2-b-and-delta-to-c">
<h2><span class="section-number">2.3.2. </span><strong>Example 2: “B and delta to C”</strong><a class="headerlink" href="#example-2-b-and-delta-to-c" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex2img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex2img.png" />
<p>A radar or sonar attached to a vehicle B (Body coordinate frame) measures the
distance and direction to an object C. We assume that the distance and two
angles (typically bearing and elevation relative to B) are already combined to
the vector p_BC_B (i.e. the vector from B to C, decomposed in B). The position
of B is given as n_EB_E and z_EB, and the orientation (attitude) of B is given
as R_NB (this rotation matrix can be found from roll/pitch/yaw by using zyx2R).</p>
<p>Find the exact position of object C as n-vector and depth ( n_EC_E and z_EC ),
assuming Earth ellipsoid with semi-major axis a and flattening f. For WGS-72,
use a = 6 378 135 m and f = 1/298.26.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
</pre></div>
</div>
</dd>
<dt>A custom reference ellipsoid is given (replacing WGS-84):</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wgs72</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">6378135</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">298.26</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step 1 Position and orientation of B is 400m above E:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">unit</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>  <span class="c1"># unit to get unit length of vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_EB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R_NB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">zyx2R</span><span class="p">(</span><span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">roll</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step 2: Delta BC decomposed in B</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_BC_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Step 3: Find R_EN:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R_EN</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2R_EN</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step 4: Find R_EB, from R_EN and R_NB:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R_EB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R_EN</span><span class="p">,</span> <span class="n">R_NB</span><span class="p">)</span>  <span class="c1"># Note: closest frames cancel</span>
</pre></div>
</div>
</dd>
<dt>Step 5: Decompose the delta BC vector in E:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_BC_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R_EB</span><span class="p">,</span> <span class="n">p_BC_B</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Step 6: Find the position of C, using the functions that goes from one</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span><span class="p">,</span> <span class="n">z_EC</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_EA_E_and_p_AB_E2n_EB_E</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">,</span> <span class="n">p_BC_E</span><span class="p">,</span> <span class="n">z_EB</span><span class="p">,</span> <span class="o">**</span><span class="n">wgs72</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EC</span><span class="p">,</span> <span class="n">lon_EC</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EC_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat_EC</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon_EC</span><span class="p">),</span> <span class="n">z_EC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex2: PosC: lat, lon = </span><span class="si">{:4.2f}</span><span class="s1">, </span><span class="si">{:4.2f}</span><span class="s1"> deg,  height = </span><span class="si">{:4.2f}</span><span class="s1"> m&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex2: PosC: lat, lon = 53.33, 63.47 deg,  height = 406.01 m&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_2">Example 2 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-3-ecef-vector-to-geodetic-latitude">
<h2><span class="section-number">2.3.3. </span><strong>Example 3: “ECEF-vector to geodetic latitude”</strong><a class="headerlink" href="#example-3-ecef-vector-to-geodetic-latitude" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex3img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex3img.png" />
<p>Position B is given as an “ECEF-vector” p_EB_E (i.e. a vector from E, the
center of the Earth, to B, decomposed in E).
Find the geodetic latitude, longitude and height (latEB, lonEB and hEB),
assuming WGS-84 ellipsoid.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">deg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wgs84</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">6378137.0</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">298.257223563</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_EB_E</span> <span class="o">=</span> <span class="mf">6371e3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>  <span class="c1"># m</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span><span class="p">,</span> <span class="n">z_EB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">p_EB_E2n_EB_E</span><span class="p">(</span><span class="n">p_EB_E</span><span class="p">,</span> <span class="o">**</span><span class="n">wgs84</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="o">-</span><span class="n">z_EB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat_EB</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon_EB</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex3: Pos B: lat, lon = </span><span class="si">{:4.2f}</span><span class="s1">, </span><span class="si">{:4.2f}</span><span class="s1"> deg, height = </span><span class="si">{:9.2f}</span><span class="s1"> m&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex3: Pos B: lat, lon = 39.38, -48.01 deg, height = 4702059.83 m&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_3">Example 3 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-4-geodetic-latitude-to-ecef-vector">
<h2><span class="section-number">2.3.4. </span><strong>Example 4: “Geodetic latitude to ECEF-vector”</strong><a class="headerlink" href="#example-4-geodetic-latitude-to-ecef-vector" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex4img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex4img.png" />
<p>Geodetic latitude, longitude and height are given for position B as latEB,
lonEB and hEB, find the ECEF-vector for this position, p_EB_E.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wgs84</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">6378137.0</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">298.257223563</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_EB</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_EB_E2p_EB_E</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">,</span> <span class="o">-</span><span class="n">h_EB</span><span class="p">,</span> <span class="o">**</span><span class="n">wgs84</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;Ex4: p_EB_E = </span><span class="si">{}</span><span class="s1"> m&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_EB_E</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="go">&#39;Ex4: p_EB_E = [6373290.277218279, 222560.20067473652, 110568.82718178593] m&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_4">Example 4 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-5-surface-distance">
<h2><span class="section-number">2.3.5. </span><strong>Example 5: “Surface distance”</strong><a class="headerlink" href="#example-5-surface-distance" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex5img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex5img.png" />
<p>Find the surface distance sAB (i.e. great circle distance) between two
positions A and B. The heights of A and B are ignored, i.e. if they don’t have
zero height, we seek the distance between the points that are at the surface of
the Earth, directly above/below A and B. The Euclidean distance (chord length)
dAB should also be found. Use Earth radius 6371e3 m.
Compare the results with exact calculations for the WGS-84 ellipsoid.</p>
<dl>
<dt>Solution for a sphere:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">88</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">89</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_Earth</span> <span class="o">=</span> <span class="mf">6371e3</span>  <span class="c1"># m, mean Earth radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_AB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">great_circle_distance</span><span class="p">(</span><span class="n">n_EA_E</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">r_Earth</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_AB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">euclidean_distance</span><span class="p">(</span><span class="n">n_EA_E</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">r_Earth</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex5: Great circle and Euclidean distance = </span><span class="si">{}</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5.2f}</span><span class="s1"> km, </span><span class="si">{:5.2f}</span><span class="s1"> km&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_AB</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">d_AB</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
<span class="go">&#39;Ex5: Great circle and Euclidean distance = 332.46 km, 332.42 km&#39;</span>
</pre></div>
</div>
</dd>
<dt>Exact solution for the WGS84 ellipsoid:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wgs84</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">FrameE</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;WGS84&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point1</span> <span class="o">=</span> <span class="n">wgs84</span><span class="o">.</span><span class="n">GeoPoint</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point2</span> <span class="o">=</span> <span class="n">wgs84</span><span class="o">.</span><span class="n">GeoPoint</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">89</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=-</span><span class="mi">170</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_12</span><span class="p">,</span> <span class="n">_azi1</span><span class="p">,</span> <span class="n">_azi2</span> <span class="o">=</span> <span class="n">point1</span><span class="o">.</span><span class="n">distance_and_azimuth</span><span class="p">(</span><span class="n">point2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p_12_E</span> <span class="o">=</span> <span class="n">point2</span><span class="o">.</span><span class="n">to_ecef_vector</span><span class="p">()</span> <span class="o">-</span> <span class="n">point1</span><span class="o">.</span><span class="n">to_ecef_vector</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_12</span> <span class="o">=</span> <span class="n">p_12_E</span><span class="o">.</span><span class="n">length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ellipsoidal and Euclidean distance = </span><span class="si">{:5.2f}</span><span class="s1"> km, </span><span class="si">{:5.2f}</span><span class="s1"> km&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_12</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">d_12</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
<span class="go">&#39;Ellipsoidal and Euclidean distance = 333.95 km, 333.91 km&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_5">Example 5 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-6-interpolated-position">
<h2><span class="section-number">2.3.6. </span><strong>Example 6 “Interpolated position”</strong><a class="headerlink" href="#example-6-interpolated-position" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex6img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex6img.png" />
<p>Given the position of B at time t0 and t1, n_EB_E(t0) and n_EB_E(t1).</p>
<p>Find an interpolated position at time ti, n_EB_E(ti). All positions are given
as n-vectors.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E_t0</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">89</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E_t1</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">89</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">180</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span> <span class="o">=</span> <span class="mf">16.</span>  <span class="c1"># time of interpolation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">ti</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="c1"># normalized time of interpolation</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E_ti</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="n">n_EB_E_t0</span> <span class="o">+</span> <span class="n">ti_n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_EB_E_t1</span> <span class="o">-</span> <span class="n">n_EB_E_t0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EB_ti</span><span class="p">,</span> <span class="n">lon_EB_ti</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EB_E_ti</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat_ti</span><span class="p">,</span> <span class="n">lon_ti</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat_EB_ti</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon_EB_ti</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex6, Interpolated position: lat, lon = </span><span class="si">{:2.1f}</span><span class="s1"> deg, </span><span class="si">{:2.1f}</span><span class="s1"> deg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat_ti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon_ti</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex6, Interpolated position: lat, lon = 89.8 deg, 180.0 deg&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_6">Example 6 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-7-mean-position">
<h2><span class="section-number">2.3.7. </span><strong>Example 7: “Mean position”</strong><a class="headerlink" href="#example-7-mean-position" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex7img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex7img.png" />
<p>Three positions A, B, and C are given as n-vectors n_EA_E, n_EB_E, and n_EC_E.
Find the mean position, M, given as n_EM_E.
Note that the calculation is independent of the depths of the positions.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EM_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="n">n_EA_E</span> <span class="o">+</span> <span class="n">n_EB_E</span> <span class="o">+</span> <span class="n">n_EC_E</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>or</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EM_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">mean_horizontal_position</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">n_EA_E</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">)))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EM_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex7: Pos M: lat, lon = </span><span class="si">{:4.2f}</span><span class="s1">, </span><span class="si">{:4.2f}</span><span class="s1"> deg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex7: Pos M: lat, lon = 67.24, -6.92 deg&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_7">Example 7 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-8-a-and-azimuth-distance-to-b">
<h2><span class="section-number">2.3.8. </span><strong>Example 8: “A and azimuth/distance to B”</strong><a class="headerlink" href="#example-8-a-and-azimuth-distance-to-b" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex8img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex8img.png" />
<p>We have an initial position A, direction of travel given as an azimuth
(bearing) relative to north (clockwise), and finally the
distance to travel along a great circle given as sAB.
Use Earth radius 6371e3 m to find the destination point B.</p>
<p>In geodesy this is known as “The first geodetic problem” or
“The direct geodetic problem” for a sphere, and we see that this is similar to
<a class="reference external" href="http://www.navlab.net/nvector/#example_2">Example 2</a>, but now the delta is
given as an azimuth and a great circle distance. (“The second/inverse geodetic
problem” for a sphere is already solved in Examples
<a class="reference external" href="http://www.navlab.net/nvector/#example_1">1</a> and
<a class="reference external" href="http://www.navlab.net/nvector/#example_5">5</a>.)</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">azimuth</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_AB</span> <span class="o">=</span> <span class="mf">1000.0</span>  <span class="c1"># [m]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_earth</span> <span class="o">=</span> <span class="mf">6371e3</span>  <span class="c1"># [m], mean earth radius</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_rad</span> <span class="o">=</span> <span class="n">s_AB</span> <span class="o">/</span> <span class="n">r_earth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_EA_E_distance_and_azimuth2n_EB_E</span><span class="p">(</span><span class="n">n_EA_E</span><span class="p">,</span> <span class="n">distance_rad</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EB</span><span class="p">,</span> <span class="n">lon_EB</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat_EB</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon_EB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex8, Destination: lat, lon = </span><span class="si">{:4.2f}</span><span class="s1"> deg, </span><span class="si">{:4.2f}</span><span class="s1"> deg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex8, Destination: lat, lon = 79.99 deg, -90.02 deg&#39;</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_8">Example 8 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-9-intersection-of-two-paths">
<h2><span class="section-number">2.3.9. </span><strong>Example 9: “Intersection of two paths”</strong><a class="headerlink" href="#example-9-intersection-of-two-paths" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex9img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex9img.png" />
<p>Define a path from two given positions (at the surface of a spherical Earth),
as the great circle that goes through the two points.</p>
<p>Path A is given by A1 and A2, while path B is given by B1 and B2.</p>
<p>Find the position C where the two great circles intersect.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA1_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA2_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB1_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB2_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">70</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">n_EA1_E</span><span class="p">,</span> <span class="n">n_EA2_E</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                          <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">n_EB1_E</span><span class="p">,</span> <span class="n">n_EB2_E</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                          <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n_EC_E</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">n_EA1_E</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>or alternatively</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path_a</span><span class="p">,</span> <span class="n">path_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_EA1_E</span><span class="p">,</span> <span class="n">n_EA2_E</span><span class="p">),</span> <span class="p">(</span><span class="n">n_EB1_E</span><span class="p">,</span> <span class="n">n_EB2_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">path_a</span><span class="p">,</span> <span class="n">path_b</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat_EC</span><span class="p">,</span> <span class="n">lon_EC</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">n_E2lat_lon</span><span class="p">(</span><span class="n">n_EC_E</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">lat_EC</span><span class="p">),</span> <span class="n">deg</span><span class="p">(</span><span class="n">lon_EC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Ex9, Intersection: lat, lon = </span><span class="si">{:4.2f}</span><span class="s1">, </span><span class="si">{:4.2f}</span><span class="s1"> deg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Ex9, Intersection: lat, lon = 40.32, 55.90 deg&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">nv</span><span class="o">.</span><span class="n">on_great_circle_path</span><span class="p">(</span><span class="n">path_a</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">),</span>
<span class="gp">... </span>            <span class="n">nv</span><span class="o">.</span><span class="n">on_great_circle_path</span><span class="p">(</span><span class="n">path_b</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">nv</span><span class="o">.</span><span class="n">on_great_circle</span><span class="p">(</span><span class="n">path_a</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">),</span> <span class="n">nv</span><span class="o">.</span><span class="n">on_great_circle</span><span class="p">(</span><span class="n">path_b</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_9">Example 9 at www.navlab.net</a></p>
</dd>
</dl>
</div>
<div class="section" id="example-10-cross-track-distance">
<h2><span class="section-number">2.3.10. </span><strong>Example 10: “Cross track distance”</strong><a class="headerlink" href="#example-10-cross-track-distance" title="Permalink to this headline">¶</a></h2>
<img alt="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex10img.png" src="https://raw.githubusercontent.com/pbrod/Nvector/master/docs/tutorials/images/ex10img.png" />
<p>Path A is given by the two positions A1 and A2 (similar to the previous
example).</p>
<p>Find the cross track distance sxt between the path A (i.e. the great circle
through A1 and A2) and the position B (i.e. the shortest distance at the
surface, between the great circle and B).</p>
<p>Also find the Euclidean distance dxt between B and the plane defined by the
great circle. Use Earth radius 6371e3.</p>
<p>Finally, find the intersection point on the great circle and determine if it is
between position A1 and A2.</p>
<dl>
<dt>Solution:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">nvector</span> <span class="k">as</span> <span class="nn">nv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nvector</span> <span class="kn">import</span> <span class="n">rad</span><span class="p">,</span> <span class="n">deg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA1_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EA2_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_EB_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">lat_lon2n_E</span><span class="p">(</span><span class="n">rad</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">rad</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_EA1_E</span><span class="p">,</span> <span class="n">n_EA2_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="mf">6371e3</span>  <span class="c1"># mean earth radius [m]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_xt</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">cross_track_distance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_xt</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">cross_track_distance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val_txt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:4.2f}</span><span class="s1"> km, </span><span class="si">{:4.2f}</span><span class="s1"> km&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_xt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">d_xt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;Ex10: Cross track distance: s_xt, d_xt = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val_txt</span><span class="p">)</span>
<span class="go">&#39;Ex10: Cross track distance: s_xt, d_xt = 11.12 km, 11.12 km&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_EC_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">closest_point_on_great_circle</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">nv</span><span class="o">.</span><span class="n">on_great_circle_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">,</span> <span class="n">radius</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd>
<dt>Alternative solution 2:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_xt2</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">great_circle_distance</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_xt2</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">euclidean_distance</span><span class="p">(</span><span class="n">n_EB_E</span><span class="p">,</span> <span class="n">n_EC_E</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">s_xt</span><span class="p">,</span> <span class="n">s_xt2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">d_xt</span><span class="p">,</span> <span class="n">d_xt2</span><span class="p">)</span>
<span class="go">(True, True)</span>
</pre></div>
</div>
</dd>
<dt>Alternative solution 3:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c_E</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">great_circle_normal</span><span class="p">(</span><span class="n">n_EA1_E</span><span class="p">,</span> <span class="n">n_EA2_E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_E</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">n_EB_E</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_xt3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_xt3</span> <span class="o">=</span> <span class="n">sin_theta</span> <span class="o">*</span> <span class="n">radius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">s_xt</span><span class="p">,</span> <span class="n">s_xt3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">d_xt</span><span class="p">,</span> <span class="n">d_xt3</span><span class="p">)</span>
<span class="go">(True, True)</span>
</pre></div>
</div>
</dd>
<dt>See also</dt><dd><p><a class="reference external" href="http://www.navlab.net/nvector/#example_10">Example 10 at www.navlab.net</a></p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="whatsnext.html" class="btn btn-neutral float-right" title="2.4. What to read next" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral float-left" title="2.2. Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2020, Norwegian Defence Research Establishment (FFI)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
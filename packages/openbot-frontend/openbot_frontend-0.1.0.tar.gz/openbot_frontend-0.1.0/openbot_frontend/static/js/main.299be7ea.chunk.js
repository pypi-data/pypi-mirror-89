(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{225:function(e,t,n){},227:function(e,t,n){},269:function(e,t,n){},305:function(e,t,n){},411:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(3),s=n(35),i=n.n(s),o=(n(225),n(39)),j=n(15),d=n(433),l=n(434),u=n(417),b=n(424),h=n(435),O=(n(226),n(227),n(421)),p=new Set,x=new Set,f=function e(){x.forEach((function(e){return e("connecting")}));var t=window.location.protocol.replace("http","ws"),n=new WebSocket("".concat(t,"//").concat(window.location.host,"/ws"));return n.addEventListener("open",(function(){console.log("ws.open"),x.forEach((function(e){return e("connected")}))})),n.addEventListener("message",(function(e){console.log("ws.message",e.data);var t=JSON.parse(e.data);p.forEach((function(n){n(t,e)}))})),n.addEventListener("close",(function(){console.warn("ws.closed"),x.forEach((function(e){return e("closed")})),setTimeout((function(){f=e()}),3e3)})),n.addEventListener("error",(function(){console.error("ws.error")})),n}(),m=1;function v(e,t){return new Promise((function(n,c){var a=m++,r=w((function(e){"2.0"===e.jsonrpc&&e.id===a&&(r(),e.error?c(e.error):n(e.result))}));g({jsonrpc:"2.0",method:e,params:t,id:a}),setTimeout((function(){r(),c("JsonRpc timeout")}),1e4)}))}function g(e){if(f.readyState===WebSocket.OPEN){var t=JSON.stringify(e);console.log("ws.send",t),f.send(t)}else var n=y((function(t){"connected"===t&&(n(),g(e))}))}function w(e){return p.add(e),function(){p.delete(e)}}function y(e){return x.add(e),function(){x.delete(e)}}function S(){return Object(c.useEffect)((function(){return y((function(e){"connected"!==e?O.a.warning({title:"Not connected",key:"connection"}):O.a.close("connection")}))}),[]),null}var E=n(16),k=n(426);n(269);function C(e){return Object(r.jsx)("div",Object(E.a)({className:"grid-view"},e))}var T=n(24);function N(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(c.useReducer)(F,e)}function F(e){return!e}function _(e,t,n){var a=Object(c.useState)(),r=Object(T.a)(a,2),s=r[0],i=r[1],o=Object(c.useState)(!0),j=Object(T.a)(o,2),d=j[0],l=j[1],u=Object(c.useState)(e),b=Object(T.a)(u,2),h=b[0],O=b[1],p=N(!1),x=Object(T.a)(p,2),f=x[0],m=x[1],g=Object(c.useMemo)((function(){return n}),[JSON.stringify(n)]);return Object(c.useEffect)((function(){l(!0);var e=!0;return console.log("useRpc",t,g),v(t,g).then((function(t){e&&(O(t),i(void 0),l(!1))})).catch((function(t){e&&(console.error(t),i(t),l(!1))})),function(){e=!1}}),[t,g,f]),{error:s,pending:d,value:h,reload:m}}var I={train:[{name:"loading...",path:"",sessions:[]}],test:[{name:"loading...",path:"",sessions:[]}]};function A(){return _(I,"getDatasets")}function M(){var e=A();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Train datasets"}),Object(r.jsx)(C,{children:e.value.train.map((function(e){return Object(r.jsx)(H,Object(E.a)({},e),e.name)}))}),Object(r.jsx)("h3",{children:"Test datasets"}),Object(r.jsx)(C,{children:e.value.test.map((function(e){return Object(r.jsx)(H,Object(E.a)({},e),e.name)}))})]})}function H(e){return Object(r.jsxs)(k.a,{header:Object(r.jsx)(o.b,{to:e.path,children:e.name}),shaded:!0,children:[Object(r.jsxs)("div",{children:["Sessions: ",e.sessions.length]}),Object(r.jsxs)("div",{children:["Frames: ",e.sessions.reduce((function(e,t){return e+t.frames}),0)]})]})}var D=[];function L(){var e=_(D,"getModels");return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Models"}),e.value.map((function(e){return Object(r.jsx)(R,Object(E.a)({},e),e.name)}))]})}function R(e){return Object(r.jsx)(k.a,{header:Object(r.jsx)(o.b,{to:e.name,children:e.name}),shaded:!0,children:Object(r.jsxs)(C,{children:[Object(r.jsx)(B,{model:e.name,rnd:"",name:"error"}),Object(r.jsx)(B,{model:e.name,rnd:"",name:"direction"}),Object(r.jsx)(B,{model:e.name,rnd:"",name:"angle"}),Object(r.jsx)(B,{model:e.name,rnd:"",name:"loss"})]})})}function B(e){return Object(r.jsx)("img",{alt:"".concat(e.name," plot"),src:"/models/".concat(e.model,"/logs/").concat(e.name,".png?rnd=").concat(e.rnd)})}var P=n(65),U=n(427),J=n(428),z=n(28),G=n(422),V=n(415),W=n(429),Y=n(423),Z=n(425),q=n(430),K=n(431);n(305);function Q(e){return Object(r.jsx)("div",Object(E.a)({className:"button-bar"},e))}var X={};function $(){var e=Object(c.useState)(void 0),t=Object(T.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(void 0),i=Object(T.a)(s,2),o=i[0],j=i[1],d=Object(c.useState)(void 0),l=Object(T.a)(d,2),u=l[0],b=l[1],h=Object(c.useState)(""),O=Object(T.a)(h,2),p=O[0],x=O[1],f=Object(c.useState)(0),m=Object(T.a)(f,2),g=m[0],y=m[1],S=Object(c.useRef)(X);var E=_(X,"getHyperparameters"),N=E.pending,F=E.value;return Object(c.useEffect)((function(){return w((function(e){switch(e.event){case"started":a("active"),b(void 0);break;case"preview":y(Date.now());break;case"progress":j(Math.round(100*e.payload.epoch)),b(Math.round(100*e.payload.train));break;case"cancelled":a("fail");break;case"done":y(Date.now()),a("success"),x(e.payload.model)}}))}),[]),N?null:Object(r.jsxs)("div",{className:"trainPage",children:[Object(r.jsx)("h3",{children:"Model training"}),Object(r.jsxs)(k.a,{shaded:!0,header:"Hyperparameters",children:[Object(r.jsx)(U.a,{description:"You may have to tune the learning rate and batch size depending on your available compute resources and dataset. As a general rule of thumb, if you increase the batch size by a factor of n, you can increase the learning rate by a factor of sqrt(n)."}),Object(r.jsxs)(J.a,{onChange:function(e){Object.keys(e).forEach((function(t){var n=e[t];e[t]="string"===typeof n?Number(n):n})),console.log(e),S.current=e},formDefaultValue:F,layout:"horizontal",children:[Object(r.jsx)(te,{name:"TRAIN_BATCH_SIZE",min:1}),Object(r.jsx)(te,{name:"TEST_BATCH_SIZE",min:1}),Object(r.jsx)(te,{name:"LEARNING_RATE",min:0,step:1e-4}),Object(r.jsx)(te,{name:"NUM_EPOCHS",min:1,help:"For debugging and hyperparamter tuning, you can set the number of epochs to a small value like 10. If you want to train a model which will achieve good performance, you should set it to 50 or more. In our paper we used 100."}),Object(r.jsxs)(k.a,{bordered:!0,header:"Advanced parameters",collapsible:!0,children:[Object(r.jsx)(U.a,{type:"warning",description:"Don't change these unless you know what you are doing"}),Object(r.jsx)(ne,{name:"BATCH_NORM",defaultChecked:F.BATCH_NORM}),Object(r.jsx)(ne,{name:"FLIP_AUG",defaultChecked:F.FLIP_AUG}),Object(r.jsx)(ne,{name:"CMD_AUG",defaultChecked:F.CMD_AUG})]})]}),Object(r.jsxs)(Q,{children:[Object(r.jsx)(z.a,{onClick:function(){return v("start",S.current)},appearance:"primary",children:"Start"}),Object(r.jsx)(z.a,{onClick:function(){return v("stop")},children:"Stop"})]})]}),!!u&&Object(r.jsxs)(k.a,{shaded:!0,header:"Progress",children:[Object(r.jsxs)("div",{children:["Current epoch:",Object(r.jsx)(G.a.Line,{percent:o})]}),Object(r.jsxs)("div",{children:["Training:",Object(r.jsx)(G.a.Line,{percent:u,status:n})]})]}),!!g&&Object(r.jsx)(k.a,{bodyFill:!0,shaded:!0,header:"Train preview",collapsible:!0,defaultExpanded:!0,children:Object(r.jsx)("img",{alt:"preview thumbnails",src:"/models/train_preview.png?rnd="+g})}),p&&Object(r.jsx)(k.a,{bodyFill:!0,shaded:!0,header:"Test preview",collapsible:!0,defaultExpanded:!0,children:Object(r.jsx)("img",{alt:"preview thumbnails",src:"/models/".concat(p,"/logs/test_preview.png?rnd=").concat(g)})}),p&&Object(r.jsxs)(C,{children:[Object(r.jsx)(ee,{model:p,rnd:g,name:"error"}),Object(r.jsx)(ee,{model:p,rnd:g,name:"direction"}),Object(r.jsx)(ee,{model:p,rnd:g,name:"angle"}),Object(r.jsx)(ee,{model:p,rnd:g,name:"loss"})]})]})}function ee(e){return Object(r.jsx)(k.a,{bodyFill:!0,shaded:!0,children:Object(r.jsx)("img",{alt:"".concat(e.name," plot"),src:"/models/".concat(e.model,"/logs/").concat(e.name,".png?rnd=").concat(e.rnd)})})}function te(e){var t=e.help,n=Object(P.a)(e,["help"]);return Object(r.jsxs)(V.a,{children:[Object(r.jsx)(W.a,{children:n.name}),Object(r.jsx)(Y.a,Object(E.a)({accepter:Z.a},n)),t&&Object(r.jsx)(q.a,{children:t})]})}function ne(e){return Object(r.jsxs)("div",{className:"bool-input",children:[Object(r.jsx)(W.a,{children:e.name}),Object(r.jsx)(Y.a,Object(E.a)({accepter:K.a},e))]})}var ce=n(432),ae=n(420),re=n(419);function se(e){var t=e.path,n=Object(P.a)(e,["path"]);return Object(r.jsxs)(re.a,Object(E.a)(Object(E.a)({backdrop:"static",size:"xs"},n),{},{children:[Object(r.jsx)(re.a.Header,{children:Object(r.jsx)(re.a.Title,{children:"Are you really want to delete this session?"})}),Object(r.jsx)(re.a.Body,{children:Object(r.jsx)("img",{src:"".concat(t,"/preview.gif"),alt:"preview"})}),Object(r.jsxs)(re.a.Footer,{children:[Object(r.jsx)(z.a,{onClick:function(){return function(e){v("deleteSession",{path:e})}(t)},appearance:"primary",children:"Yes"}),Object(r.jsx)(z.a,{onClick:n.onHide,appearance:"subtle",children:"No"})]})]}))}var ie=n(418);function oe(e){var t=e.path,n=Object(P.a)(e,["path"]),a=function(e){return[{value:"uploaded",label:"uploaded"},{value:"train",label:"train",children:e.train.map((function(e){return{value:e.path,label:e.name}}))},{value:"test",label:"test",children:e.test.map((function(e){return{value:e.path,label:e.name}}))}]}(A().value),s=Object(c.useRef)("");return Object(r.jsx)(re.a,Object(E.a)(Object(E.a)({backdrop:"static",size:"xs"},n),{},{children:Object(r.jsxs)(J.a,{onSubmit:function(){v("moveSession",{path:t,new_path:s.current})},children:[Object(r.jsx)(re.a.Header,{children:Object(r.jsx)(re.a.Title,{children:"Move session"})}),Object(r.jsx)(re.a.Body,{children:Object(r.jsxs)(V.a,{children:[Object(r.jsx)(W.a,{children:"To folder:"}),Object(r.jsx)(ie.a,{name:"new_path",data:a,defaultValue:"uploaded",defaultExpandAll:!0,disabledItemValues:["train","test"],onChange:function(e){console.log(e),s.current=e},block:!0})]})}),Object(r.jsxs)(re.a.Footer,{children:[Object(r.jsx)(z.a,{type:"submit",appearance:"primary",children:"Move"}),Object(r.jsx)(z.a,{onClick:n.onHide,appearance:"subtle",children:"Cancel"})]})]})}))}var je={basename:"",path:"",session:void 0,file_list:[]};function de(){var e=Object(j.g)();return Object(r.jsxs)(j.c,{children:[Object(r.jsx)(j.a,{path:e.url+"/:path",component:le}),Object(r.jsx)(j.a,{component:ue})]})}function le(){var e=Object(j.f)().path,t=_(je,"listDir",{path:"uploaded/"+e}).value.session;return Object(r.jsxs)(k.a,{shaded:!0,children:[Object(r.jsx)("h3",{children:e}),t?Object(r.jsx)(be,Object(E.a)({},t)):Object(r.jsx)(ce.a,{})]})}function ue(){var e=_(je,"listDir",{path:"uploaded"}),t=e.value,n=e.reload;return Object(c.useEffect)((function(){return w((function(e){"deleteSessionSuccess"!==e.event&&"moveSessionSuccess"!==e.event||n()}))}),[n]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h3",{children:"Uploaded sessions"}),Object(r.jsxs)(C,{children:[!t.file_list.length&&Object(r.jsx)(k.a,{shaded:!0,children:"No sessions"}),t.file_list.map((function(e){return Object(r.jsx)(k.a,{bodyFill:!0,shaded:!0,children:Object(r.jsx)(be,Object(E.a)({},e))},e.path)}))]})]})}function be(e){var t=N(!1),n=Object(T.a)(t,2),c=n[0],a=n[1],s=N(!1),i=Object(T.a)(s,2),j=i[0],d=i[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("img",{src:"".concat(e.path,"/preview.gif"),alt:"preview"}),Object(r.jsxs)(k.a,{children:[Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(r.jsx)(o.b,{to:e.path,children:e.name}),Object(r.jsxs)(ae.a,{title:"Actions",children:[Object(r.jsx)(ae.a.Item,{onSelect:a,children:"Move..."}),Object(r.jsx)(ae.a.Item,{onSelect:d,children:"Remove..."})]})]}),Object(r.jsxs)("div",{children:["Frames: ",e.frames]})]}),c&&Object(r.jsx)(oe,{path:e.path,show:c,onHide:a}),Object(r.jsx)(se,{path:e.path,show:j,onHide:d})]})}var he=function(){return Object(r.jsxs)(d.a,{className:"App",children:[Object(r.jsx)(l.a,{children:Object(r.jsxs)(u.a,{appearance:"inverse",children:[Object(r.jsx)(u.a.Header,{children:Object(r.jsx)("a",{href:"#/",className:"navbar-brand logo",children:"OpenBot Driving Policy Trainer"})}),Object(r.jsx)(u.a.Body,{children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(b.a.Item,{href:"#/",children:"Datasets"}),Object(r.jsx)(b.a.Item,{href:"#/models",children:"Models"}),Object(r.jsx)(b.a.Item,{href:"#/uploaded",children:"Uploaded"}),Object(r.jsx)(b.a.Item,{href:"#/train",children:"Train"})]})})]})}),Object(r.jsx)(h.a,{children:Object(r.jsxs)(j.c,{children:[Object(r.jsx)(j.a,{path:"/models",children:Object(r.jsx)(L,{})}),Object(r.jsx)(j.a,{path:"/uploaded",children:Object(r.jsx)(de,{})}),Object(r.jsx)(j.a,{path:"/train",children:Object(r.jsx)($,{})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(M,{})})]})}),Object(r.jsx)(S,{})]})},Oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,436)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(o.a,{children:Object(r.jsx)(he,{})})}),document.getElementById("root")),Oe()}},[[411,1,2]]]);
//# sourceMappingURL=main.299be7ea.chunk.js.map
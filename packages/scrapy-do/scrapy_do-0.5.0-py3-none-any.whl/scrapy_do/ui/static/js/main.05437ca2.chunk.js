(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{113:function(e,t,s){},114:function(e,t,s){},374:function(e,t,s){"use strict";s.r(t),s.d(t,"store",(function(){return Be}));var n=s(1),c=s(0),a=s(26),i=s.n(a),r=(s(111),s(112),s(113),s(114),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function o(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l=s(44),d=s(57),j=s(27),u=s(15),h="BACKEND_STATUS_SET",b="BACKEND_COUNTDOWN_SET",p="BACKEND_CONNECTING",O="BACKEND_OPENED";function m(e){return{type:h,status:e}}var v={status:p,countdown:0};var f="DAEMON_STATUS_SET",x="PROJECTS_STATUS_SET",y="JOBS_STATUS_SET";var g={memoryUsage:0,cpuUsage:0,time:0,timezone:"UTC",hostname:"unknown",uptime:"0m",daemonVersion:"0.0.0",projects:0,spiders:0,jobsRun:0,jobsSuccessful:0,jobsFailed:0,jobsCanceled:0,jobsScheduled:0};var w="PROJECT_PUSH",C="PROJECT_REMOVE",E="PROJECT_LIST_SET";var S={};var N="JOB_LIST_SET",D="JOB_UPDATE",T="JOB_REMOVE";var k={};function _(e,t){var s=Object.assign(e);return"ACTIVE"in s&&delete s.ACTIVE[t],"COMPLETED"in s&&delete s.COMPLETED[t],s}function L(e){return"SCHEDULED"===e||"PENDING"===e||"RUNNING"===e?"ACTIVE":"COMPLETED"}var I=s(104),M=s(14);function P(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function U(e){if("now"===e)return!0;var t=e.toLowerCase().split(" ");if(0===t.length)return!1;if("every"!==t[0])return!1;if(t.length<2)return!1;var s=parseInt(t[1],10);if(isNaN(s))t=t.slice(1);else{if(t.length<3)return!1;t=t.slice(2)}var n=["second","seconds","minute","minutes","hour","hours","day","days","week","weeks","monday","tuesday","wednesday","thursday","friday","saturday","sunday","at","to"];for(t=t.reverse();t.length;){var c=t.pop();if(n.indexOf(c)<0)return!1;if("to"===c){if(!t.length)return!1;var a=t.pop();if(a=parseInt(a,10),isNaN(a))return!1}else if("at"===c){if(!t.length)return!1;var i=t.pop(),r=i.split(":");if(2!==r.length)return!1;if(i=parseInt(r[0],10),isNaN(i))return!1;if(i=parseInt(r[1],10),isNaN(i))return!1}}return!0}function R(e){var t=null;try{t=JSON.parse(e)}catch(s){return!1}return"object"===typeof t&&null!==t}var A=function e(){var t=this;Object(M.a)(this,e),this.connect=function(){if(t.ws)throw Error("Socket not closed");t.countdownTimer&&clearInterval(t.countdownTimer),t.dispatchEvent(e.CONNECTING,null),t.ws=new WebSocket(t.wsUrl),t.ws.onopen=function(){t.dispatchEvent(e.OPENED,null),t.nextTry=2},t.ws.onmessage=function(s){var n=JSON.parse(s.data);t.dispatchEvent(e.MSG_RECEIVED,n)},t.ws.onclose=function(){t.dispatchEvent(e.CLOSED,null),t.ws=null,t.nextTry*=2,t.nextTry>256&&(t.nextTry=256),t.countdown=t.nextTry-1,t.dispatchEvent(e.COUNTDOWN,t.countdown+1);t.countdownTimer=setInterval((function(){t.dispatchEvent(e.COUNTDOWN,t.countdown),0!==t.countdown?t.countdown-=1:t.connect()}),1e3)}},this.addEventListener=function(e){t.eventListeners.add(e)},this.removeEventListener=function(e){t.eventListeners.delete(e)},this.dispatchEvent=function(s,n){var c,a=[],i=Object(I.a)(t.eventListeners);try{for(i.s();!(c=i.n()).done;){var r=c.value;r(s,n)===e.REMOVE_LISTENER&&a.push(r)}}catch(j){i.e(j)}finally{i.f()}for(var o=0,l=a;o<l.length;o++){var d=l[o];t.removeEventListener(d)}},this.sendMessage=function(s){if(!t.ws||t.ws.readyState!==WebSocket.OPEN)return Promise.reject(new Error("Backend not connected."));var n=function(e){for(var t="",s="abcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=s.charAt(Math.floor(Math.random()*s.length));return t}(32),c=Object.assign(s,{type:"ACTION",id:n});return new Promise((function(s,a){t.addEventListener((function(t,c){if(t===e.CLOSED)return a(new Error("Backend disconnected")),e.REMOVE_LISTENER;if(t===e.MSG_RECEIVED&&"ACTION_EXECUTED"===c.type&&c.id===n){if("OK"===c.status){var i=Object.assign(c);delete i.type,delete i.id,delete i.status,s(i)}else a(new Error(c.message));return e.REMOVE_LISTENER}return null})),t.ws.send(JSON.stringify(c))}))};var s=window.location,n="https:"===s.protocol?"wss:":"ws:";this.wsUrl="".concat(n,"//").concat(s.host,"/ws"),this.ws=null,this.countdownTimer=null,this.countdown=0,this.nextTry=2,this.eventListeners=new Set,this.connect()};A.CONNECTING=0,A.OPENED=1,A.CLOSED=2,A.MSG_RECEIVED=3,A.COUNTDOWN=4,A.REMOVE_LISTENER=0;var B=new A,V=s(16),z=s(18),J=s(17),F=s(20),G=s(29),K=s(47),W=s(59),H=s(53),Y=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){return Object(n.jsxs)(W.a,{bg:"dark",variant:"dark",collapseOnSelect:!0,expand:"md",children:[Object(n.jsx)(H.LinkContainer,{to:"/",children:Object(n.jsx)(W.a.Brand,{children:"Scrapy Do"})}),Object(n.jsx)(W.a.Toggle,{"aria-controls":"navbar"}),Object(n.jsxs)(W.a.Collapse,{id:"navbar",children:[Object(n.jsx)(K.a,{className:"mr-auto"}),Object(n.jsxs)(K.a,{children:[Object(n.jsx)(H.LinkContainer,{to:"/dashboard",children:Object(n.jsxs)(K.a.Link,{children:[Object(n.jsx)(G.d,{})," Dashboard"]})}),Object(n.jsx)(H.LinkContainer,{to:"/project-list",children:Object(n.jsxs)(K.a.Link,{children:[Object(n.jsx)(G.a,{})," Projects"]})}),Object(n.jsx)(H.LinkContainer,{to:"/job-list/active",children:Object(n.jsxs)(K.a.Link,{children:[Object(n.jsx)(G.b,{})," Active Jobs"]})}),Object(n.jsx)(H.LinkContainer,{to:"/job-list/completed",children:Object(n.jsxs)(K.a.Link,{children:[Object(n.jsx)(G.g,{})," Completed Jobs"]})})]})]})]})}}]),s}(c.Component),X=s(87),q=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){return this.props.status===O?Object(n.jsx)("div",{}):this.props.status===p?Object(n.jsx)("div",{className:"col-md-4 col-md-offset-4",children:Object(n.jsx)(X.a,{variant:"primary",onClick:this.retryNow,children:Object(n.jsx)("div",{className:"alert-content",children:"Connecting..."})})}):Object(n.jsx)("div",{className:"col-md-4 col-md-offset-4",children:Object(n.jsx)(X.a,{variant:"primary",type:"button",children:Object(n.jsxs)("div",{className:"alert-content",children:["Disconnected. Connecting in",Object(n.jsxs)("strong",{children:[" ",this.props.countdown]}),1===this.props.countdown?" second":" seconds",". Click ",Object(n.jsx)("a",{className:"alert-link",onClick:function(e){e.preventDefault(),B.connect()},href:"#n",children:"here"})," to try now."]})})})}}]),s}(c.Component);var Q=Object(j.b)((function(e,t){return{status:e.backend.status,countdown:e.backend.countdown}}),(function(e){return{}}))(q),$=s(376),Z=s(73),ee=s.n(Z),te=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){var e=ee.a.unix(this.props.time).tz(this.props.timezone).format("YYYY-MM-DD HH:mm");return Object(n.jsx)("div",{className:"col-md-6 col-md-offset-3",children:Object(n.jsxs)("div",{className:"dashboard-content",children:[Object(n.jsx)("img",{src:"scrapy-do-logo.png",alt:"Scrapy-Do Logo"}),Object(n.jsxs)("div",{className:"text-summary",children:[Object(n.jsxs)("div",{children:["Version ",this.props.daemonVersion," @ ",this.props.hostname]}),Object(n.jsxs)("div",{children:["Server time: ",e," (",this.props.timezone,")"]}),Object(n.jsxs)("div",{children:["Uptime: ",this.props.uptime," | CPU Usage: ",this.props.cpuUsage,"% | Memory Usage: ",this.props.memoryUsage,"MB"]}),Object(n.jsxs)("div",{children:["Projects: ",this.props.projects," | Spiders: ",this.props.spiders]}),Object(n.jsx)("div",{className:"jobs-summary",children:Object(n.jsxs)($.a,{striped:!0,bordered:!0,size:"sm",children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Jobs Run"}),Object(n.jsx)("th",{children:"Successful"}),Object(n.jsx)("th",{children:"Failed"}),Object(n.jsx)("th",{children:"Canceled"}),Object(n.jsx)("th",{children:"Scheduled"})]})}),Object(n.jsx)("tbody",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:this.props.jobsRun}),Object(n.jsx)("td",{children:this.props.jobsSuccessful}),Object(n.jsx)("td",{children:this.props.jobsFailed}),Object(n.jsx)("td",{children:this.props.jobsCanceled}),Object(n.jsx)("td",{children:this.props.jobsScheduled})]})})]})})]}),Object(n.jsxs)("div",{className:"text-summary",children:["[",Object(n.jsx)(l.Link,{to:"/about",children:"About"}),"]"]})]})})}}]),s}(c.Component);var se=Object(j.b)((function(e,t){return Object(u.a)({},e.status)}),(function(e){return{}}))(te),ne=s(21),ce=s(42);function ae(e){return B.sendMessage({action:"PROJECT_REMOVE",name:e})}function ie(e){return B.sendMessage({action:"PROJECT_PUSH",archiveData:e})}function re(e){return B.sendMessage({action:"JOB_CANCEL",jobId:e})}function oe(e,t,s,n,c){return B.sendMessage({action:"JOB_SCHEDULE",project:e,spider:t,schedule:s,description:n,payload:c})}var le=s(30),de=s(22),je=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,text:""},e.close=function(){e.setState({visible:!1})},e.show=function(t){e.setState({visible:!0,text:t})},e}return Object(V.a)(s,[{key:"render",value:function(){return Object(n.jsx)(le.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"sm",children:Object(n.jsxs)(le.a.Body,{children:[Object(n.jsx)("div",{className:"dialog-content-center",children:this.state.text}),Object(n.jsx)("hr",{}),Object(n.jsx)("div",{className:"alert-content",children:Object(n.jsx)(ne.a,{variant:"secondary",onClick:this.close,children:"OK"})})]})})}}]),s}(c.Component),ue=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,project:"__select",spider:"__select",schedule:"now",description:"",payload:"{\n}",projectsDisabled:!1,spidersDisabled:!0,scheduleDisabled:!0,submitDisabled:!0,scheduleValidated:!0,payloadValidated:!0},e.close=function(){e.setState({visible:!1})},e.show=function(t,s){e.setState({visible:!0,project:t||"__select",spider:s||"__select",schedule:"now",description:"",payload:"{\n}",projectsDisabled:!!t,spidersDisabled:!0,scheduleDisabled:!t||!s,submitDisabled:!t||!s,scheduleValidated:!0,payloadValidated:!0})},e.schedule=function(){oe(e.state.project,e.state.spider,e.state.schedule,e.state.description,e.state.payload).catch((function(t){setTimeout((function(){return e.alert.show(t.message)}),250)})),e.close()},e.onProjectChange=function(t){"__select"===t.target.value?e.setState({spidersDisabled:!0,scheduleDisabled:!0,submitDisabled:!0,project:t.target.value}):e.setState({spidersDisabled:!1,project:t.target.value})},e.onSpiderChange=function(t){"__select"===t.target.value?e.setState({scheduleDisabled:!0,submitDisabled:!0,spider:t.target.value}):e.setState({scheduleDisabled:!1,submitDisabled:!U(e.state.schedule),spider:t.target.value})},e.onScheduleChange=function(t){var s=U(t.target.value);e.setState({schedule:t.target.value,scheduleValidated:s,submitDisabled:!s})},e.onPayloadChange=function(t){var s=R(t.target.value);e.setState({payload:t.target.value,payloadValidated:s,submitDisabled:!s})},e}return Object(V.a)(s,[{key:"componentDidMount",value:function(){this.props.provideController({show:this.show})}},{key:"componentWillUnmount",value:function(){this.props.provideController(null)}},{key:"render",value:function(){var e=this,t=Object(n.jsxs)(de.a.Group,{controlId:"projectSelect",children:[Object(n.jsx)(de.a.Label,{children:"Project"}),Object(n.jsxs)(de.a.Control,{as:"select",placeholder:"__select",disabled:this.state.projectsDisabled,onChange:this.onProjectChange,value:this.state.project,children:[Object(n.jsx)("option",{value:"__select",children:"Select Project"}),this.props.__projects.map((function(e){return Object(n.jsx)("option",{value:e,children:e},e)}))]})]}),s=[];"__select"!==this.state.project&&this.state.project in this.props&&(s=this.props[this.state.project].spiders);var c=Object(n.jsxs)(de.a.Group,{controlId:"spiderSelect",children:[Object(n.jsx)(de.a.Label,{children:"Spider"}),Object(n.jsxs)(de.a.Control,{as:"select",placeholder:"__select",disabled:this.state.spidersDisabled,onChange:this.onSpiderChange,value:this.state.spider,children:[Object(n.jsx)("option",{value:"__select",children:"Select Spider"}),s.map((function(e){return Object(n.jsx)("option",{value:e,children:e},e)}))]})]}),a="https://scrapy-do.readthedocs.io/en/latest/basic-concepts.html#scheduling-specs",i=Object(n.jsxs)(de.a.Group,{controlId:"scheduleInput",children:[Object(n.jsx)(de.a.Label,{children:"Schedule"}),Object(n.jsx)(de.a.Control,{type:"text",disabled:this.state.scheduleDisabled,value:this.state.schedule,onChange:this.onScheduleChange,isInvalid:!this.state.scheduleValidated,isValid:this.state.scheduleValidated}),Object(n.jsxs)(de.a.Control.Feedback,{type:"valid",children:["See the ",Object(n.jsx)("a",{href:a,children:"docs"})," on scheduling specs."]}),Object(n.jsxs)(de.a.Control.Feedback,{type:"invalid",children:["See the ",Object(n.jsx)("a",{href:a,children:"docs"})," on scheduling specs."]})]}),r=Object(n.jsxs)(de.a.Group,{controlId:"descriptionInput",children:[Object(n.jsx)(de.a.Label,{children:"Description (optional)"}),Object(n.jsx)(de.a.Control,{type:"text",disabled:this.state.scheduleDisabled,value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})}})]}),o=Object(n.jsxs)(de.a.Group,{controlId:"payloadInput",children:[Object(n.jsx)(de.a.Label,{children:"Payload (optional)"}),Object(n.jsx)(de.a.Control,{as:"textarea",rows:5,disabled:this.state.scheduleDisabled,value:this.state.payload,onChange:this.onPayloadChange,isInvalid:!this.state.payloadValidated,isValid:this.state.payloadValidated}),Object(n.jsx)(de.a.Control.Feedback,{type:"valid",children:"Payload needs to be a valid JSON object."}),Object(n.jsx)(de.a.Control.Feedback,{type:"invalid",children:"Payload needs to be a valid JSON object."})]});return Object(n.jsxs)("div",{children:[Object(n.jsx)(je,{ref:function(t){e.alert=t}}),Object(n.jsxs)(le.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(n.jsx)(le.a.Body,{children:Object(n.jsxs)("div",{className:"dialog-content-left",children:[t,c,i,r,o]})}),Object(n.jsxs)(le.a.Footer,{children:[Object(n.jsx)(ne.a,{variant:"secondary",onClick:this.close,children:"Cancel"}),Object(n.jsx)(ne.a,{variant:"success",onClick:this.schedule,disabled:this.state.submitDisabled,children:"Schedule"})]})]})]})}}]),s}(c.Component);var he=Object(j.b)((function(e,t){return Object(u.a)({__projects:Object.keys(e.projects).sort()},e.projects)}),(function(e){return{}}))(ue),be=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,text:""},e.no=function(){e.setState({visible:!1}),e.state.no&&e.state.no.fn&&e.state.no.fn()},e.yes=function(){e.state.yes&&e.state.yes.fn&&e.state.yes.fn(),e.setState({visible:!1})},e.show=function(t,s,n){e.setState({visible:!0,text:t,yes:s,no:n})},e}return Object(V.a)(s,[{key:"render",value:function(){var e="secondary",t="primary",s="Cancel",c="Ok";return this.state.no&&(this.state.no.variant&&(e=this.state.no.variant),this.state.no.text&&(s=this.state.no.text)),this.state.yes&&(this.state.yes.variant&&(t=this.state.yes.variant),this.state.yes.text&&(c=this.state.yes.text)),Object(n.jsx)("div",{children:Object(n.jsxs)(le.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,size:"sm",children:[Object(n.jsx)(le.a.Body,{children:Object(n.jsx)("div",{className:"dialog-content-center",children:this.state.text})}),Object(n.jsxs)(le.a.Footer,{children:[Object(n.jsx)(ne.a,{variant:e,onClick:this.no,children:s}),Object(n.jsx)(ne.a,{variant:t,onClick:this.yes,children:c})]})]})})}}]),s}(c.Component),pe=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).showRemoveDialog=function(){var t=e.props,s={variant:"danger",text:"Remove",fn:function(){ae(t.name).catch((function(t){setTimeout((function(){return e.alertDialog.show(t.message)}),250)}))}},n='Are you sure you want to remove project "'.concat(t.name,'"?');e.removeDialog.show(n,s)},e}return Object(V.a)(s,[{key:"render",value:function(){var e=this,t=this.props;return Object(n.jsxs)("div",{className:"project-list-item",children:[Object(n.jsx)(be,{ref:function(t){e.removeDialog=t}}),Object(n.jsx)(je,{ref:function(t){e.alertDialog=t}}),Object(n.jsx)(he,{provideController:function(t){return e.scheduleDialogCtl=t}}),Object(n.jsxs)(ce.a,{children:[Object(n.jsx)(ce.a.Header,{children:Object(n.jsxs)("div",{className:"list-item",children:[Object(n.jsx)("div",{className:"item-panel",children:Object(n.jsxs)(ne.a,{size:"sm",variant:"secondary",disabled:!this.props.connected,onClick:this.showRemoveDialog,children:[Object(n.jsx)(G.i,{})," Remove"]})}),Object(n.jsx)("strong",{children:t.name})]})}),Object(n.jsx)(ce.a.Body,{children:Object(n.jsx)("div",{className:"spider-list",children:t.spiders.map((function(s){return Object(n.jsxs)(ne.a,{size:"sm",variant:"outline-secondary",disabled:!e.props.connected,onClick:function(){e.scheduleDialogCtl.show(t.name,s)},children:[Object(n.jsx)(G.b,{})," ",s]},s)}))})})]})]})}}]),s}(c.Component);var Oe=Object(j.b)((function(e,t){return Object(u.a)(Object(u.a)({},e.projects[t.projectName]),{},{connected:e.backend.status===O})}),(function(e){return{}}))(pe),me=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={visible:!1,pushEnabled:!1},e.close=function(){e.setState({visible:!1})},e.show=function(){e.setState({visible:!0})},e.push=function(){if(!e.archivePromise)return setTimeout((function(){return e.alert.show("No file selected.")}),250),void e.close();e.archivePromise.then((function(e){return ie(e)})).then((function(){e.archivePromise=null})).catch((function(t){setTimeout((function(){return e.alert.show(t.message)}),250)})),e.close()},e.fileSelectorChange=function(t){var s=t.target.files;s.length&&(e.setState({pushEnabled:!0}),e.archivePromise=new Promise((function(e,t){var n=new FileReader;n.readAsBinaryString(s[0]),n.onload=function(){return e(btoa(n.result))},n.onerror=function(e){return t(e)}})))},e}return Object(V.a)(s,[{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{children:[Object(n.jsx)(je,{ref:function(t){e.alert=t}}),Object(n.jsxs)(le.a,{show:this.state.visible,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(n.jsx)(le.a.Body,{children:Object(n.jsxs)("div",{className:"dialog-content-center",children:[Object(n.jsx)("label",{children:"Choose a project archive:"}),Object(n.jsx)("input",{type:"file",id:"filePicker",accept:".zip",onChange:this.fileSelectorChange})]})}),Object(n.jsxs)(le.a.Footer,{children:[Object(n.jsx)(ne.a,{variant:"secondary",onClick:this.close,children:"Cancel"}),Object(n.jsx)(ne.a,{variant:"primary",onClick:this.push,disabled:!this.state.pushEnabled,children:"Push"})]})]})]})}}]),s}(c.Component),ve=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){var e=this,t=this.props.projects,s=Object(n.jsx)(ce.a,{children:Object(n.jsx)("div",{className:"list-empty",children:"No projects."})});return t.length&&(s=Object(n.jsx)("div",{children:t.map((function(e){return Object(n.jsx)(Oe,{projectName:e},e)}))})),Object(n.jsxs)("div",{className:"col-md-8 col-md-offset-2",children:[Object(n.jsx)(me,{ref:function(t){e.dialog=t}}),Object(n.jsx)("h2",{children:"Projects"}),Object(n.jsx)("div",{className:"control-button-container",children:Object(n.jsxs)(ne.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:function(){return e.dialog.show()},children:[Object(n.jsx)(G.f,{})," Push project"]})}),s]})}}]),s}(c.Component);var fe=Object(j.b)((function(e,t){return{projects:Object.keys(e.projects).sort(),connected:e.backend.status===O}}),(function(e){return{}}))(ve),xe=s(77),ye=s(99),ge=s.n(ye),we=s(103),Ce=s(60),Ee=s(100),Se=s.n(Ee),Ne=s(88),De=s(75),Te=function(e){switch(e){case"SCHEDULED":return"primary";case"PENDING":return"warning";case"RUNNING":return"success";case"CANCELED":return"warning";case"SUCCESSFUL":return"success";case"FAILED":return"danger";default:return"primary"}};function ke(e){var t=e.text,s=e.eventKey,c=e.fn,a=Object(De.b)(s,(function(e){c&&c(),e.preventDefault()}));return Object(n.jsx)("a",{href:"foo",onClick:a,children:t})}var _e=function(e,t){var s=window.location,n="".concat(s.protocol,"//").concat(s.host),c=t?"err":"out";return"".concat(n,"/get-log/data/").concat(e,".").concat(c)},Le=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){var e;Object(M.a)(this,s);for(var n=arguments.length,c=new Array(n),a=0;a<n;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).showCancelDialog=function(){var t=e.props,s={variant:"danger",text:"Yes",fn:function(){re(t.identifier).catch((function(t){setTimeout((function(){return e.alertDialog.show(t.message)}),250)}))}};e.cancelDialog.show("Are you sure you want to cancel the job?",s,{text:"No"})},e}return Object(V.a)(s,[{key:"render",value:function(){var e=this,t=this.props,s=ee.a.unix(t.timestamp),c=s.tz(this.props.timezone).format("YYYY-MM-DD HH:mm:ss"),a=Object(n.jsx)("div",{className:"item-panel-button",children:Object(n.jsxs)(ne.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:this.showCancelDialog,children:[Object(n.jsx)(G.h,{})," Cancel"]})}),i=null,r=null,o="out-".concat(t.identifier),l=null,d=null,j="err-".concat(t.identifier);r=Object(n.jsx)(ke,{eventKey:o,text:"Out Log"}),d=Object(n.jsx)(ke,{eventKey:j,text:"Err Log"}),i=Object(n.jsx)(Ce.a.Collapse,{eventKey:o,children:Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"accordion-header",children:"Out Log"}),Object(n.jsx)("div",{style:{height:500},children:Object(n.jsx)(Ne.LazyLog,{url:_e(t.identifier,!1),stream:!0,follow:!0,extraLines:1,enableSearch:!0,caseInsensitive:!0,selectableLines:!0})})]})}),l=Object(n.jsx)(Ce.a.Collapse,{eventKey:j,children:Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"accordion-header",children:"Err Log"}),Object(n.jsx)("div",{style:{height:500},children:Object(n.jsx)(Ne.LazyLog,{url:_e(t.identifier,!0),stream:!0,follow:!0,extraLines:1,enableSearch:!0,caseInsensitive:!0,selectableLines:!0})})]})}),"COMPLETED"===this.props.jobList&&(a=null,t.outLog||(r=null,i=null),t.errLog||(d=null,l=null)),"ACTIVE"===this.props.jobList&&"RUNNING"!==t.status&&(r=null,i=null,d=null,l=null);var u=null,h=null,b="payload-".concat(t.identifier),p=JSON.stringify(JSON.parse(t.payload),null,4),O=Se.a.highlight("json",p).value;"{}"!==p&&(h=Object(n.jsx)(ke,{eventKey:b,text:"Payload"}),u=Object(n.jsx)(Ce.a.Collapse,{eventKey:b,children:Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"accordion-header",children:"Payload"}),Object(n.jsx)("pre",{className:"hljs",children:Object(n.jsx)("code",{dangerouslySetInnerHTML:{__html:O}})})]})}));var m=Object(n.jsxs)("div",{className:"item-panel",title:c,children:[r,r&&(d||h)?" | ":"",d,d&&h?" | ":"",h,a]}),v="";return""!==t.description&&(v="[".concat(t.description,"]")),Object(n.jsxs)(xe.a.Item,{children:[Object(n.jsx)(be,{ref:function(t){e.cancelDialog=t}}),Object(n.jsx)(je,{ref:function(t){e.alertDialog=t}}),Object(n.jsxs)(Ce.a,{children:[Object(n.jsxs)("div",{className:"list-group-item-body",children:[Object(n.jsxs)("div",{className:"list-item",children:[Object(n.jsx)("div",{className:"item-panel",title:c,children:s.fromNow()}),Object(n.jsx)(we.a,{variant:Te(t.status),children:t.status}),Object(n.jsxs)("strong",{children:[" ",t.spider," ",v]})," (",t.project,")"]}),Object(n.jsxs)("div",{className:"list-item-secondary",children:[m,"Scheduled by ",P(t.actor)," to run ",t.schedule,"."]})]}),u,i,l]})]})}}]),s}(c.Component);var Ie=Object(j.b)((function(e,t){return Object(u.a)(Object(u.a)({},e.jobs[t.jobList][t.jobId]),{},{timezone:e.status.timezone,connected:e.backend.status===O})}),(function(e){return{}}))(Le),Me=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){var e=this,t=this.props.jobs,s=this.props.match.params.status,c=Object(n.jsx)(ce.a,{children:Object(n.jsx)("div",{className:"list-empty",children:"No jobs."})});t.length&&(c=Object(n.jsx)(xe.a,{children:t.map((function(e){return Object(n.jsx)(Ie,{jobId:e,jobList:s.toUpperCase()},e)}))}));var a=Object(n.jsx)("div",{className:"control-button-container",children:Object(n.jsxs)(ne.a,{variant:"outline-secondary",size:"sm",disabled:!this.props.connected,onClick:function(){return e.scheduleDialogCtl.show()},children:[Object(n.jsx)(G.c,{})," Schedule a job"]})});return"completed"===s&&(a=null),Object(n.jsxs)("div",{className:"col-md-8 col-md-offset-2",children:[Object(n.jsx)(he,{provideController:function(t){return e.scheduleDialogCtl=t}}),Object(n.jsxs)("h2",{children:[P(s)," Jobs"]}),a,Object(n.jsx)("div",{className:"content-container",children:c})]})}}]),s}(c.Component);var Pe=Object(j.b)((function(e,t){var s=t.match.params.status.toUpperCase(),n=[];return s in e.jobs&&(n=Object.keys(e.jobs[s]).map((function(t){return e.jobs[s][t]})).sort(ge()("-timestamp")).map((function(e){return e.identifier}))),{jobs:n,connected:e.backend.status===O}}),(function(e){return{}}))(Me),Ue=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){return Object(n.jsx)("div",{className:"col-md-6 col-md-offset-3",children:Object(n.jsxs)("div",{className:"dashboard-content",children:[Object(n.jsxs)("div",{className:"text-summary",children:[Object(n.jsx)("div",{children:"Scrapy-Do has been developed by Lukasz Janyst"}),Object(n.jsx)("div",{children:"and is distributed under the 3-Clause BSD License."})]}),Object(n.jsx)("div",{className:"text-summary",children:Object(n.jsx)("div",{children:"It directly uses on the following packages either at runtime or for development:"})}),Object(n.jsx)("div",{className:"text-summary",children:Object(n.jsx)("div",{className:"jobs-summary",children:Object(n.jsxs)($.a,{striped:!0,bordered:!0,size:"sm",children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),Object(n.jsx)("th",{children:"License"})]})}),Object(n.jsx)("tbody",{children:[{name:"python",website:"https://www.python.org/",license:"PSFL"},{name:"scrapy",website:"https://scrapy.org/",license:"BSD"},{name:"twisted",website:"https://twistedmatrix.com/trac/",license:"MIT"},{name:"pyOpenSSL",website:"https://pyopenssl.org/",license:"Apache 2.0"},{name:"psutil",website:"https://github.com/giampaolo/psutil",license:"BSD"},{name:"python-dateutil",website:"https://dateutil.readthedocs.io/",license:"BSD"},{name:"schedule",website:"https://github.com/dbader/schedule",license:"MIT"},{name:"pem",website:"https://pem.readthedocs.io/",license:"MIT"},{name:"tabulate",website:"https://github.com/astanin/python-tabulate",license:"MIT"},{name:"requests",website:"http://python-requests.org/",license:"Apache 2.0"},{name:"autobahn",website:"http://crossbar.io/autobahn",license:"MIT"},{name:"tzlocal",website:"https://github.com/regebro/tzlocal",license:"MIT"},{name:"bootstrap",website:"https://getbootstrap.com/",license:"MIT"},{name:"highlight.js",website:"https://highlightjs.org/",license:"BSD"},{name:"moment-timezone",website:"http://momentjs.com/timezone/",license:"MIT"},{name:"prop-types",website:"https://facebook.github.io/react/",license:"MIT"},{name:"react",website:"https://github.com/facebook/react",license:"MIT"},{name:"react-dom",website:"https://github.com/facebook/react",license:"MIT"},{name:"react-icons",website:"https://github.com/react-icons/react-icons#readme",license:"MIT"},{name:"Font Awesome",website:"https://fontawesome.com/",license:"CC BY 4.0"},{name:"react-lazylog",website:"https://github.com/mozilla-frontend-infra/react-lazylog#readme",license:"MPL-2.0"},{name:"redux",website:"http://redux.js.org/",license:"MIT"},{name:"react-redux",website:"https://github.com/reduxjs/react-redux",license:"MIT"},{name:"react-router-dom",website:"https://github.com/ReactTraining/react-router#readme",license:"MIT"},{name:"rect-router-bootstrap",website:"https://github.com/react-bootstrap/react-router-bootstrap",license:"Apache 2.0"},{name:"react-scripts",website:"https://github.com/facebook/create-react-app#readme",license:"MIT"},{name:"sort-by",website:"https://github.com/kvnneff/sort-by#readme",license:"MIT"},{name:"node.js",website:"https://nodejs.org/en/",license:"MIT"},{name:"docutils",website:"http://docutils.sourceforge.net/",license:"multiple"},{name:"pygments",website:"http://pygments.org/",license:"BSD"},{name:"pytest",website:"https://docs.pytest.org/en/latest/",license:"MIT"},{name:"pytest-cov",website:"https://github.com/pytest-dev/pytest-cov",license:"BSD"},{name:"pytest-flake8",website:"https://github.com/tholo/pytest-flake8",license:"BSD"},{name:"sphinx",website:"http://sphinx-doc.org/",license:"BSD"}].map((function(e){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:Object(n.jsx)("a",{href:e.website,children:e.name})}),Object(n.jsx)("td",{children:e.license})]},e.name)}))})]})})})]})})}}]),s}(c.Component);function Re(e){return Object(n.jsx)("div",{className:"col-md-8 col-md-offset-2",children:Object(n.jsxs)("div",{style:{textAlign:"center"},children:[Object(n.jsx)("div",{style:{margin:"3em"},children:Object(n.jsx)(G.e,{size:300,color:"DimGrey"})}),Object(n.jsx)("h3",{children:"This is not what you're looking for."})]})})}var Ae=function(e){Object(z.a)(s,e);var t=Object(J.a)(s);function s(){return Object(M.a)(this,s),t.apply(this,arguments)}return Object(V.a)(s,[{key:"render",value:function(){return Object(n.jsxs)("div",{children:[Object(n.jsx)(Y,{}),Object(n.jsxs)("div",{className:"content",children:[Object(n.jsx)(Q,{}),Object(n.jsxs)(F.g,{children:[Object(n.jsx)(F.d,{exact:!0,path:"/",component:se}),Object(n.jsx)(F.d,{exact:!0,path:"/dashboard",component:se}),Object(n.jsx)(F.d,{exact:!0,path:"/project-list",component:fe}),Object(n.jsx)(F.d,{path:"/job-list/:status",component:Pe}),Object(n.jsx)(F.d,{exact:!0,path:"/about",component:Ue}),Object(n.jsx)(F.d,{component:Re})]})]})]})}}]),s}(c.Component),Be=Object(d.c)(Object(d.b)({backend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(u.a)(Object(u.a)({},e),{},{status:t.status});case b:return Object(u.a)(Object(u.a)({},e),{},{countdown:t.countdown});default:return e}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(u.a)(Object(u.a)({},e),{},{memoryUsage:t.memoryUsage,cpuUsage:t.cpuUsage,time:t.time,timezone:t.timezone,hostname:t.hostname,uptime:t.uptime,daemonVersion:t.daemonVersion});case x:return Object(u.a)(Object(u.a)({},e),{},{projects:t.projects,spiders:t.spiders});case y:return Object(u.a)(Object(u.a)({},e),{},{jobsRun:t.jobsRun,jobsSuccessful:t.jobsSuccessful,jobsFailed:t.jobsFailed,jobsCanceled:t.jobsCanceled,jobsScheduled:t.jobsScheduled});default:return e}},projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(u.a)(Object(u.a)({},e),{},{[t.name]:{name:t.name,spiders:t.spiders}});case C:var s=Object.assign(e);return delete s[t.name],s;case E:return t.projects.reduce((function(e,t){return e[t.name]=t,e}),{});default:return e}},jobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:var s=t.jobs.reduce((function(e,t){return e[t.identifier]=t,e}),{});return Object(u.a)(Object(u.a)({},e),{},{[t.status]:s});case T:return _(e,t.jobId);case D:var n=_(e,t.job.identifier),c=L(t.job.status);return n[c][t.job.identifier]=t.job,n;default:return e}}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());B.addEventListener((function(e,t){e===A.CONNECTING?Be.dispatch(m(p)):e===A.OPENED?Be.dispatch(m(O)):e===A.CLOSED?Be.dispatch(m("BACKEND_CLOSED")):e===A.COUNTDOWN&&Be.dispatch({type:b,countdown:t})})),B.addEventListener((function(e,t){var s,n,c,a,i,r,o;if(e===A.MSG_RECEIVED)switch(t.type){case"DAEMON_STATUS":Be.dispatch(function(e){var t=e.memoryUsage,s=e.cpuUsage,n=e.time,c=e.timezone,a=e.hostname,i=e.uptime,r=e.daemonVersion;return{type:f,memoryUsage:t,cpuUsage:s,time:n,timezone:c,hostname:a,uptime:i,daemonVersion:r}}(t));break;case"PROJECTS_STATUS":Be.dispatch(function(e){var t=e.projects,s=e.spiders;return{type:x,projects:t,spiders:s}}(t));break;case"JOBS_STATUS":Be.dispatch(function(e){var t=e.jobsRun,s=e.jobsSuccessful,n=e.jobsFailed,c=e.jobsCanceled,a=e.jobsScheduled;return{type:y,jobsRun:t,jobsSuccessful:s,jobsFailed:n,jobsCanceled:c,jobsScheduled:a}}(t));break;case"PROJECT_LIST":Be.dispatch((o=t.projects,{type:E,projects:o}));break;case"PROJECT_PUSH":Be.dispatch((i=t.name,r=t.spiders,{type:w,name:i,spiders:r}));break;case"PROJECT_REMOVE":Be.dispatch(function(e){return{type:C,name:e}}(t.name));break;case"JOB_LIST":Be.dispatch((c=t.status,a=t.jobs,{type:N,status:c,jobs:a}));break;case"JOB_UPDATE":Be.dispatch((n=t.job,{type:D,job:n}));break;case"JOB_REMOVE":Be.dispatch((s=t.jobId,{type:T,jobId:s}))}})),i.a.render(Object(n.jsx)(j.a,{store:Be,children:Object(n.jsx)(l.BrowserRouter,{children:Object(n.jsx)(Ae,{})})}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");r?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):o(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):o(e)}))}}()}},[[374,1,2]]]);
//# sourceMappingURL=main.05437ca2.chunk.js.map